/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
exports.id = "vendor-chunks/sift";
exports.ids = ["vendor-chunks/sift"];
exports.modules = {

/***/ "../server/node_modules/sift/index.js":
/*!********************************************!*\
  !*** ../server/node_modules/sift/index.js ***!
  \********************************************/
/***/ ((module, __unused_webpack_exports, __webpack_require__) => {

eval("const lib = __webpack_require__(/*! ./lib */ \"../server/node_modules/sift/lib/index.js\");\n\nmodule.exports = lib.default;\nObject.assign(module.exports, lib);\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi4vc2VydmVyL25vZGVfbW9kdWxlcy9zaWZ0L2luZGV4LmpzIiwibWFwcGluZ3MiOiJBQUFBLFlBQVksbUJBQU8sQ0FBQyx1REFBTzs7QUFFM0I7QUFDQSIsInNvdXJjZXMiOlsid2VicGFjazovL2NsaWVudC8uLi9zZXJ2ZXIvbm9kZV9tb2R1bGVzL3NpZnQvaW5kZXguanM/NDU0OSJdLCJzb3VyY2VzQ29udGVudCI6WyJjb25zdCBsaWIgPSByZXF1aXJlKFwiLi9saWJcIik7XG5cbm1vZHVsZS5leHBvcnRzID0gbGliLmRlZmF1bHQ7XG5PYmplY3QuYXNzaWduKG1vZHVsZS5leHBvcnRzLCBsaWIpO1xuIl0sIm5hbWVzIjpbXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///../server/node_modules/sift/index.js\n");

/***/ }),

/***/ "../server/node_modules/sift/lib/index.js":
/*!************************************************!*\
  !*** ../server/node_modules/sift/lib/index.js ***!
  \************************************************/
/***/ (function(__unused_webpack_module, exports) {

eval("(function (global, factory) {\n     true ? factory(exports) :\n    0;\n}(this, (function (exports) { 'use strict';\n\n    /*! *****************************************************************************\r\n    Copyright (c) Microsoft Corporation.\r\n\r\n    Permission to use, copy, modify, and/or distribute this software for any\r\n    purpose with or without fee is hereby granted.\r\n\r\n    THE SOFTWARE IS PROVIDED \"AS IS\" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH\r\n    REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY\r\n    AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,\r\n    INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM\r\n    LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR\r\n    OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR\r\n    PERFORMANCE OF THIS SOFTWARE.\r\n    ***************************************************************************** */\r\n    /* global Reflect, Promise */\r\n\r\n    var extendStatics = function(d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (Object.prototype.hasOwnProperty.call(b, p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n\r\n    function __extends(d, b) {\r\n        if (typeof b !== \"function\" && b !== null)\r\n            throw new TypeError(\"Class extends value \" + String(b) + \" is not a constructor or null\");\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    }\n\n    var typeChecker = function (type) {\n        var typeString = \"[object \" + type + \"]\";\n        return function (value) {\n            return getClassName(value) === typeString;\n        };\n    };\n    var getClassName = function (value) { return Object.prototype.toString.call(value); };\n    var comparable = function (value) {\n        if (value instanceof Date) {\n            return value.getTime();\n        }\n        else if (isArray(value)) {\n            return value.map(comparable);\n        }\n        else if (value && typeof value.toJSON === \"function\") {\n            return value.toJSON();\n        }\n        return value;\n    };\n    var isArray = typeChecker(\"Array\");\n    var isObject = typeChecker(\"Object\");\n    var isFunction = typeChecker(\"Function\");\n    var isVanillaObject = function (value) {\n        return (value &&\n            (value.constructor === Object ||\n                value.constructor === Array ||\n                value.constructor.toString() === \"function Object() { [native code] }\" ||\n                value.constructor.toString() === \"function Array() { [native code] }\") &&\n            !value.toJSON);\n    };\n    var equals = function (a, b) {\n        if (a == null && a == b) {\n            return true;\n        }\n        if (a === b) {\n            return true;\n        }\n        if (Object.prototype.toString.call(a) !== Object.prototype.toString.call(b)) {\n            return false;\n        }\n        if (isArray(a)) {\n            if (a.length !== b.length) {\n                return false;\n            }\n            for (var i = 0, length_1 = a.length; i < length_1; i++) {\n                if (!equals(a[i], b[i]))\n                    return false;\n            }\n            return true;\n        }\n        else if (isObject(a)) {\n            if (Object.keys(a).length !== Object.keys(b).length) {\n                return false;\n            }\n            for (var key in a) {\n                if (!equals(a[key], b[key]))\n                    return false;\n            }\n            return true;\n        }\n        return false;\n    };\n\n    /**\n     * Walks through each value given the context - used for nested operations. E.g:\n     * { \"person.address\": { $eq: \"blarg\" }}\n     */\n    var walkKeyPathValues = function (item, keyPath, next, depth, key, owner) {\n        var currentKey = keyPath[depth];\n        // if array, then try matching. Might fall through for cases like:\n        // { $eq: [1, 2, 3] }, [ 1, 2, 3 ].\n        if (isArray(item) && isNaN(Number(currentKey))) {\n            for (var i = 0, length_1 = item.length; i < length_1; i++) {\n                // if FALSE is returned, then terminate walker. For operations, this simply\n                // means that the search critera was met.\n                if (!walkKeyPathValues(item[i], keyPath, next, depth, i, item)) {\n                    return false;\n                }\n            }\n        }\n        if (depth === keyPath.length || item == null) {\n            return next(item, key, owner, depth === 0);\n        }\n        return walkKeyPathValues(item[currentKey], keyPath, next, depth + 1, currentKey, item);\n    };\n    var BaseOperation = /** @class */ (function () {\n        function BaseOperation(params, owneryQuery, options, name) {\n            this.params = params;\n            this.owneryQuery = owneryQuery;\n            this.options = options;\n            this.name = name;\n            this.init();\n        }\n        BaseOperation.prototype.init = function () { };\n        BaseOperation.prototype.reset = function () {\n            this.done = false;\n            this.keep = false;\n        };\n        return BaseOperation;\n    }());\n    var GroupOperation = /** @class */ (function (_super) {\n        __extends(GroupOperation, _super);\n        function GroupOperation(params, owneryQuery, options, children) {\n            var _this = _super.call(this, params, owneryQuery, options) || this;\n            _this.children = children;\n            return _this;\n        }\n        /**\n         */\n        GroupOperation.prototype.reset = function () {\n            this.keep = false;\n            this.done = false;\n            for (var i = 0, length_2 = this.children.length; i < length_2; i++) {\n                this.children[i].reset();\n            }\n        };\n        /**\n         */\n        GroupOperation.prototype.childrenNext = function (item, key, owner, root) {\n            var done = true;\n            var keep = true;\n            for (var i = 0, length_3 = this.children.length; i < length_3; i++) {\n                var childOperation = this.children[i];\n                if (!childOperation.done) {\n                    childOperation.next(item, key, owner, root);\n                }\n                if (!childOperation.keep) {\n                    keep = false;\n                }\n                if (childOperation.done) {\n                    if (!childOperation.keep) {\n                        break;\n                    }\n                }\n                else {\n                    done = false;\n                }\n            }\n            this.done = done;\n            this.keep = keep;\n        };\n        return GroupOperation;\n    }(BaseOperation));\n    var NamedGroupOperation = /** @class */ (function (_super) {\n        __extends(NamedGroupOperation, _super);\n        function NamedGroupOperation(params, owneryQuery, options, children, name) {\n            var _this = _super.call(this, params, owneryQuery, options, children) || this;\n            _this.name = name;\n            return _this;\n        }\n        return NamedGroupOperation;\n    }(GroupOperation));\n    var QueryOperation = /** @class */ (function (_super) {\n        __extends(QueryOperation, _super);\n        function QueryOperation() {\n            var _this = _super !== null && _super.apply(this, arguments) || this;\n            _this.propop = true;\n            return _this;\n        }\n        /**\n         */\n        QueryOperation.prototype.next = function (item, key, parent, root) {\n            this.childrenNext(item, key, parent, root);\n        };\n        return QueryOperation;\n    }(GroupOperation));\n    var NestedOperation = /** @class */ (function (_super) {\n        __extends(NestedOperation, _super);\n        function NestedOperation(keyPath, params, owneryQuery, options, children) {\n            var _this = _super.call(this, params, owneryQuery, options, children) || this;\n            _this.keyPath = keyPath;\n            _this.propop = true;\n            /**\n             */\n            _this._nextNestedValue = function (value, key, owner, root) {\n                _this.childrenNext(value, key, owner, root);\n                return !_this.done;\n            };\n            return _this;\n        }\n        /**\n         */\n        NestedOperation.prototype.next = function (item, key, parent) {\n            walkKeyPathValues(item, this.keyPath, this._nextNestedValue, 0, key, parent);\n        };\n        return NestedOperation;\n    }(GroupOperation));\n    var createTester = function (a, compare) {\n        if (a instanceof Function) {\n            return a;\n        }\n        if (a instanceof RegExp) {\n            return function (b) {\n                var result = typeof b === \"string\" && a.test(b);\n                a.lastIndex = 0;\n                return result;\n            };\n        }\n        var comparableA = comparable(a);\n        return function (b) { return compare(comparableA, comparable(b)); };\n    };\n    var EqualsOperation = /** @class */ (function (_super) {\n        __extends(EqualsOperation, _super);\n        function EqualsOperation() {\n            var _this = _super !== null && _super.apply(this, arguments) || this;\n            _this.propop = true;\n            return _this;\n        }\n        EqualsOperation.prototype.init = function () {\n            this._test = createTester(this.params, this.options.compare);\n        };\n        EqualsOperation.prototype.next = function (item, key, parent) {\n            if (!Array.isArray(parent) || parent.hasOwnProperty(key)) {\n                if (this._test(item, key, parent)) {\n                    this.done = true;\n                    this.keep = true;\n                }\n            }\n        };\n        return EqualsOperation;\n    }(BaseOperation));\n    var createEqualsOperation = function (params, owneryQuery, options) { return new EqualsOperation(params, owneryQuery, options); };\n    var NopeOperation = /** @class */ (function (_super) {\n        __extends(NopeOperation, _super);\n        function NopeOperation() {\n            var _this = _super !== null && _super.apply(this, arguments) || this;\n            _this.propop = true;\n            return _this;\n        }\n        NopeOperation.prototype.next = function () {\n            this.done = true;\n            this.keep = false;\n        };\n        return NopeOperation;\n    }(BaseOperation));\n    var numericalOperationCreator = function (createNumericalOperation) { return function (params, owneryQuery, options, name) {\n        if (params == null) {\n            return new NopeOperation(params, owneryQuery, options, name);\n        }\n        return createNumericalOperation(params, owneryQuery, options, name);\n    }; };\n    var numericalOperation = function (createTester) {\n        return numericalOperationCreator(function (params, owneryQuery, options, name) {\n            var typeofParams = typeof comparable(params);\n            var test = createTester(params);\n            return new EqualsOperation(function (b) {\n                return typeof comparable(b) === typeofParams && test(b);\n            }, owneryQuery, options, name);\n        });\n    };\n    var createNamedOperation = function (name, params, parentQuery, options) {\n        var operationCreator = options.operations[name];\n        if (!operationCreator) {\n            throwUnsupportedOperation(name);\n        }\n        return operationCreator(params, parentQuery, options, name);\n    };\n    var throwUnsupportedOperation = function (name) {\n        throw new Error(\"Unsupported operation: \" + name);\n    };\n    var containsOperation = function (query, options) {\n        for (var key in query) {\n            if (options.operations.hasOwnProperty(key) || key.charAt(0) === \"$\")\n                return true;\n        }\n        return false;\n    };\n    var createNestedOperation = function (keyPath, nestedQuery, parentKey, owneryQuery, options) {\n        if (containsOperation(nestedQuery, options)) {\n            var _a = createQueryOperations(nestedQuery, parentKey, options), selfOperations = _a[0], nestedOperations = _a[1];\n            if (nestedOperations.length) {\n                throw new Error(\"Property queries must contain only operations, or exact objects.\");\n            }\n            return new NestedOperation(keyPath, nestedQuery, owneryQuery, options, selfOperations);\n        }\n        return new NestedOperation(keyPath, nestedQuery, owneryQuery, options, [\n            new EqualsOperation(nestedQuery, owneryQuery, options)\n        ]);\n    };\n    var createQueryOperation = function (query, owneryQuery, _a) {\n        if (owneryQuery === void 0) { owneryQuery = null; }\n        var _b = _a === void 0 ? {} : _a, compare = _b.compare, operations = _b.operations;\n        var options = {\n            compare: compare || equals,\n            operations: Object.assign({}, operations || {})\n        };\n        var _c = createQueryOperations(query, null, options), selfOperations = _c[0], nestedOperations = _c[1];\n        var ops = [];\n        if (selfOperations.length) {\n            ops.push(new NestedOperation([], query, owneryQuery, options, selfOperations));\n        }\n        ops.push.apply(ops, nestedOperations);\n        if (ops.length === 1) {\n            return ops[0];\n        }\n        return new QueryOperation(query, owneryQuery, options, ops);\n    };\n    var createQueryOperations = function (query, parentKey, options) {\n        var selfOperations = [];\n        var nestedOperations = [];\n        if (!isVanillaObject(query)) {\n            selfOperations.push(new EqualsOperation(query, query, options));\n            return [selfOperations, nestedOperations];\n        }\n        for (var key in query) {\n            if (options.operations.hasOwnProperty(key)) {\n                var op = createNamedOperation(key, query[key], query, options);\n                if (op) {\n                    if (!op.propop && parentKey && !options.operations[parentKey]) {\n                        throw new Error(\"Malformed query. \" + key + \" cannot be matched against property.\");\n                    }\n                }\n                // probably just a flag for another operation (like $options)\n                if (op != null) {\n                    selfOperations.push(op);\n                }\n            }\n            else if (key.charAt(0) === \"$\") {\n                throwUnsupportedOperation(key);\n            }\n            else {\n                nestedOperations.push(createNestedOperation(key.split(\".\"), query[key], key, query, options));\n            }\n        }\n        return [selfOperations, nestedOperations];\n    };\n    var createOperationTester = function (operation) { return function (item, key, owner) {\n        operation.reset();\n        operation.next(item, key, owner);\n        return operation.keep;\n    }; };\n    var createQueryTester = function (query, options) {\n        if (options === void 0) { options = {}; }\n        return createOperationTester(createQueryOperation(query, null, options));\n    };\n\n    var $Ne = /** @class */ (function (_super) {\n        __extends($Ne, _super);\n        function $Ne() {\n            var _this = _super !== null && _super.apply(this, arguments) || this;\n            _this.propop = true;\n            return _this;\n        }\n        $Ne.prototype.init = function () {\n            this._test = createTester(this.params, this.options.compare);\n        };\n        $Ne.prototype.reset = function () {\n            _super.prototype.reset.call(this);\n            this.keep = true;\n        };\n        $Ne.prototype.next = function (item) {\n            if (this._test(item)) {\n                this.done = true;\n                this.keep = false;\n            }\n        };\n        return $Ne;\n    }(BaseOperation));\n    // https://docs.mongodb.com/manual/reference/operator/query/elemMatch/\n    var $ElemMatch = /** @class */ (function (_super) {\n        __extends($ElemMatch, _super);\n        function $ElemMatch() {\n            var _this = _super !== null && _super.apply(this, arguments) || this;\n            _this.propop = true;\n            return _this;\n        }\n        $ElemMatch.prototype.init = function () {\n            if (!this.params || typeof this.params !== \"object\") {\n                throw new Error(\"Malformed query. $elemMatch must by an object.\");\n            }\n            this._queryOperation = createQueryOperation(this.params, this.owneryQuery, this.options);\n        };\n        $ElemMatch.prototype.reset = function () {\n            _super.prototype.reset.call(this);\n            this._queryOperation.reset();\n        };\n        $ElemMatch.prototype.next = function (item) {\n            if (isArray(item)) {\n                for (var i = 0, length_1 = item.length; i < length_1; i++) {\n                    // reset query operation since item being tested needs to pass _all_ query\n                    // operations for it to be a success\n                    this._queryOperation.reset();\n                    var child = item[i];\n                    this._queryOperation.next(child, i, item, false);\n                    this.keep = this.keep || this._queryOperation.keep;\n                }\n                this.done = true;\n            }\n            else {\n                this.done = false;\n                this.keep = false;\n            }\n        };\n        return $ElemMatch;\n    }(BaseOperation));\n    var $Not = /** @class */ (function (_super) {\n        __extends($Not, _super);\n        function $Not() {\n            var _this = _super !== null && _super.apply(this, arguments) || this;\n            _this.propop = true;\n            return _this;\n        }\n        $Not.prototype.init = function () {\n            this._queryOperation = createQueryOperation(this.params, this.owneryQuery, this.options);\n        };\n        $Not.prototype.reset = function () {\n            _super.prototype.reset.call(this);\n            this._queryOperation.reset();\n        };\n        $Not.prototype.next = function (item, key, owner, root) {\n            this._queryOperation.next(item, key, owner, root);\n            this.done = this._queryOperation.done;\n            this.keep = !this._queryOperation.keep;\n        };\n        return $Not;\n    }(BaseOperation));\n    var $Size = /** @class */ (function (_super) {\n        __extends($Size, _super);\n        function $Size() {\n            var _this = _super !== null && _super.apply(this, arguments) || this;\n            _this.propop = true;\n            return _this;\n        }\n        $Size.prototype.init = function () { };\n        $Size.prototype.next = function (item) {\n            if (isArray(item) && item.length === this.params) {\n                this.done = true;\n                this.keep = true;\n            }\n            // if (parent && parent.length === this.params) {\n            //   this.done = true;\n            //   this.keep = true;\n            // }\n        };\n        return $Size;\n    }(BaseOperation));\n    var assertGroupNotEmpty = function (values) {\n        if (values.length === 0) {\n            throw new Error(\"$and/$or/$nor must be a nonempty array\");\n        }\n    };\n    var $Or = /** @class */ (function (_super) {\n        __extends($Or, _super);\n        function $Or() {\n            var _this = _super !== null && _super.apply(this, arguments) || this;\n            _this.propop = false;\n            return _this;\n        }\n        $Or.prototype.init = function () {\n            var _this = this;\n            assertGroupNotEmpty(this.params);\n            this._ops = this.params.map(function (op) {\n                return createQueryOperation(op, null, _this.options);\n            });\n        };\n        $Or.prototype.reset = function () {\n            this.done = false;\n            this.keep = false;\n            for (var i = 0, length_2 = this._ops.length; i < length_2; i++) {\n                this._ops[i].reset();\n            }\n        };\n        $Or.prototype.next = function (item, key, owner) {\n            var done = false;\n            var success = false;\n            for (var i = 0, length_3 = this._ops.length; i < length_3; i++) {\n                var op = this._ops[i];\n                op.next(item, key, owner);\n                if (op.keep) {\n                    done = true;\n                    success = op.keep;\n                    break;\n                }\n            }\n            this.keep = success;\n            this.done = done;\n        };\n        return $Or;\n    }(BaseOperation));\n    var $Nor = /** @class */ (function (_super) {\n        __extends($Nor, _super);\n        function $Nor() {\n            var _this = _super !== null && _super.apply(this, arguments) || this;\n            _this.propop = false;\n            return _this;\n        }\n        $Nor.prototype.next = function (item, key, owner) {\n            _super.prototype.next.call(this, item, key, owner);\n            this.keep = !this.keep;\n        };\n        return $Nor;\n    }($Or));\n    var $In = /** @class */ (function (_super) {\n        __extends($In, _super);\n        function $In() {\n            var _this = _super !== null && _super.apply(this, arguments) || this;\n            _this.propop = true;\n            return _this;\n        }\n        $In.prototype.init = function () {\n            var _this = this;\n            this._testers = this.params.map(function (value) {\n                if (containsOperation(value, _this.options)) {\n                    throw new Error(\"cannot nest $ under \" + _this.name.toLowerCase());\n                }\n                return createTester(value, _this.options.compare);\n            });\n        };\n        $In.prototype.next = function (item, key, owner) {\n            var done = false;\n            var success = false;\n            for (var i = 0, length_4 = this._testers.length; i < length_4; i++) {\n                var test = this._testers[i];\n                if (test(item)) {\n                    done = true;\n                    success = true;\n                    break;\n                }\n            }\n            this.keep = success;\n            this.done = done;\n        };\n        return $In;\n    }(BaseOperation));\n    var $Nin = /** @class */ (function (_super) {\n        __extends($Nin, _super);\n        function $Nin(params, ownerQuery, options, name) {\n            var _this = _super.call(this, params, ownerQuery, options, name) || this;\n            _this.propop = true;\n            _this._in = new $In(params, ownerQuery, options, name);\n            return _this;\n        }\n        $Nin.prototype.next = function (item, key, owner, root) {\n            this._in.next(item, key, owner);\n            if (isArray(owner) && !root) {\n                if (this._in.keep) {\n                    this.keep = false;\n                    this.done = true;\n                }\n                else if (key == owner.length - 1) {\n                    this.keep = true;\n                    this.done = true;\n                }\n            }\n            else {\n                this.keep = !this._in.keep;\n                this.done = true;\n            }\n        };\n        $Nin.prototype.reset = function () {\n            _super.prototype.reset.call(this);\n            this._in.reset();\n        };\n        return $Nin;\n    }(BaseOperation));\n    var $Exists = /** @class */ (function (_super) {\n        __extends($Exists, _super);\n        function $Exists() {\n            var _this = _super !== null && _super.apply(this, arguments) || this;\n            _this.propop = true;\n            return _this;\n        }\n        $Exists.prototype.next = function (item, key, owner) {\n            if (owner.hasOwnProperty(key) === this.params) {\n                this.done = true;\n                this.keep = true;\n            }\n        };\n        return $Exists;\n    }(BaseOperation));\n    var $And = /** @class */ (function (_super) {\n        __extends($And, _super);\n        function $And(params, owneryQuery, options, name) {\n            var _this = _super.call(this, params, owneryQuery, options, params.map(function (query) { return createQueryOperation(query, owneryQuery, options); }), name) || this;\n            _this.propop = false;\n            assertGroupNotEmpty(params);\n            return _this;\n        }\n        $And.prototype.next = function (item, key, owner, root) {\n            this.childrenNext(item, key, owner, root);\n        };\n        return $And;\n    }(NamedGroupOperation));\n    var $All = /** @class */ (function (_super) {\n        __extends($All, _super);\n        function $All(params, owneryQuery, options, name) {\n            var _this = _super.call(this, params, owneryQuery, options, params.map(function (query) { return createQueryOperation(query, owneryQuery, options); }), name) || this;\n            _this.propop = true;\n            return _this;\n        }\n        $All.prototype.next = function (item, key, owner, root) {\n            this.childrenNext(item, key, owner, root);\n        };\n        return $All;\n    }(NamedGroupOperation));\n    var $eq = function (params, owneryQuery, options) {\n        return new EqualsOperation(params, owneryQuery, options);\n    };\n    var $ne = function (params, owneryQuery, options, name) { return new $Ne(params, owneryQuery, options, name); };\n    var $or = function (params, owneryQuery, options, name) { return new $Or(params, owneryQuery, options, name); };\n    var $nor = function (params, owneryQuery, options, name) { return new $Nor(params, owneryQuery, options, name); };\n    var $elemMatch = function (params, owneryQuery, options, name) { return new $ElemMatch(params, owneryQuery, options, name); };\n    var $nin = function (params, owneryQuery, options, name) { return new $Nin(params, owneryQuery, options, name); };\n    var $in = function (params, owneryQuery, options, name) {\n        return new $In(params, owneryQuery, options, name);\n    };\n    var $lt = numericalOperation(function (params) { return function (b) { return b < params; }; });\n    var $lte = numericalOperation(function (params) { return function (b) { return b <= params; }; });\n    var $gt = numericalOperation(function (params) { return function (b) { return b > params; }; });\n    var $gte = numericalOperation(function (params) { return function (b) { return b >= params; }; });\n    var $mod = function (_a, owneryQuery, options) {\n        var mod = _a[0], equalsValue = _a[1];\n        return new EqualsOperation(function (b) { return comparable(b) % mod === equalsValue; }, owneryQuery, options);\n    };\n    var $exists = function (params, owneryQuery, options, name) { return new $Exists(params, owneryQuery, options, name); };\n    var $regex = function (pattern, owneryQuery, options) {\n        return new EqualsOperation(new RegExp(pattern, owneryQuery.$options), owneryQuery, options);\n    };\n    var $not = function (params, owneryQuery, options, name) { return new $Not(params, owneryQuery, options, name); };\n    var typeAliases = {\n        number: function (v) { return typeof v === \"number\"; },\n        string: function (v) { return typeof v === \"string\"; },\n        bool: function (v) { return typeof v === \"boolean\"; },\n        array: function (v) { return Array.isArray(v); },\n        null: function (v) { return v === null; },\n        timestamp: function (v) { return v instanceof Date; }\n    };\n    var $type = function (clazz, owneryQuery, options) {\n        return new EqualsOperation(function (b) {\n            if (typeof clazz === \"string\") {\n                if (!typeAliases[clazz]) {\n                    throw new Error(\"Type alias does not exist\");\n                }\n                return typeAliases[clazz](b);\n            }\n            return b != null ? b instanceof clazz || b.constructor === clazz : false;\n        }, owneryQuery, options);\n    };\n    var $and = function (params, ownerQuery, options, name) { return new $And(params, ownerQuery, options, name); };\n    var $all = function (params, ownerQuery, options, name) { return new $All(params, ownerQuery, options, name); };\n    var $size = function (params, ownerQuery, options) { return new $Size(params, ownerQuery, options, \"$size\"); };\n    var $options = function () { return null; };\n    var $where = function (params, ownerQuery, options) {\n        var test;\n        if (isFunction(params)) {\n            test = params;\n        }\n        else if (!process.env.CSP_ENABLED) {\n            test = new Function(\"obj\", \"return \" + params);\n        }\n        else {\n            throw new Error(\"In CSP mode, sift does not support strings in \\\"$where\\\" condition\");\n        }\n        return new EqualsOperation(function (b) { return test.bind(b)(b); }, ownerQuery, options);\n    };\n\n    var defaultOperations = /*#__PURE__*/Object.freeze({\n        __proto__: null,\n        $Size: $Size,\n        $eq: $eq,\n        $ne: $ne,\n        $or: $or,\n        $nor: $nor,\n        $elemMatch: $elemMatch,\n        $nin: $nin,\n        $in: $in,\n        $lt: $lt,\n        $lte: $lte,\n        $gt: $gt,\n        $gte: $gte,\n        $mod: $mod,\n        $exists: $exists,\n        $regex: $regex,\n        $not: $not,\n        $type: $type,\n        $and: $and,\n        $all: $all,\n        $size: $size,\n        $options: $options,\n        $where: $where\n    });\n\n    var createDefaultQueryOperation = function (query, ownerQuery, _a) {\n        var _b = _a === void 0 ? {} : _a, compare = _b.compare, operations = _b.operations;\n        return createQueryOperation(query, ownerQuery, {\n            compare: compare,\n            operations: Object.assign({}, defaultOperations, operations || {})\n        });\n    };\n    var createDefaultQueryTester = function (query, options) {\n        if (options === void 0) { options = {}; }\n        var op = createDefaultQueryOperation(query, null, options);\n        return createOperationTester(op);\n    };\n\n    exports.$Size = $Size;\n    exports.$all = $all;\n    exports.$and = $and;\n    exports.$elemMatch = $elemMatch;\n    exports.$eq = $eq;\n    exports.$exists = $exists;\n    exports.$gt = $gt;\n    exports.$gte = $gte;\n    exports.$in = $in;\n    exports.$lt = $lt;\n    exports.$lte = $lte;\n    exports.$mod = $mod;\n    exports.$ne = $ne;\n    exports.$nin = $nin;\n    exports.$nor = $nor;\n    exports.$not = $not;\n    exports.$options = $options;\n    exports.$or = $or;\n    exports.$regex = $regex;\n    exports.$size = $size;\n    exports.$type = $type;\n    exports.$where = $where;\n    exports.EqualsOperation = EqualsOperation;\n    exports.createDefaultQueryOperation = createDefaultQueryOperation;\n    exports.createEqualsOperation = createEqualsOperation;\n    exports.createOperationTester = createOperationTester;\n    exports.createQueryOperation = createQueryOperation;\n    exports.createQueryTester = createQueryTester;\n    exports.default = createDefaultQueryTester;\n\n    Object.defineProperty(exports, '__esModule', { value: true });\n\n})));\n//# sourceMappingURL=index.js.map\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi4vc2VydmVyL25vZGVfbW9kdWxlcy9zaWZ0L2xpYi9pbmRleC5qcyIsIm1hcHBpbmdzIjoiQUFBQTtBQUNBLElBQUksS0FBNEQ7QUFDaEUsSUFBSSxDQUNvRDtBQUN4RCxDQUFDLDZCQUE2Qjs7QUFFOUI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsZUFBZSxnQkFBZ0Isc0NBQXNDLGtCQUFrQjtBQUN2Riw4QkFBOEI7QUFDOUI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSx3QkFBd0I7QUFDeEI7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSwwQ0FBMEM7QUFDMUM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxzRUFBc0UsZUFBZTtBQUNyRixxRUFBcUUsZUFBZTtBQUNwRjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGlEQUFpRCxjQUFjO0FBQy9EO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBLFNBQVMsb0JBQW9CO0FBQzdCO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsYUFBYSxnQkFBZ0I7QUFDN0I7QUFDQSxvREFBb0QsY0FBYztBQUNsRTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDZEQUE2RCxjQUFjO0FBQzNFO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSw2REFBNkQsY0FBYztBQUMzRTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSw4QkFBOEI7QUFDOUI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTCwwRUFBMEU7QUFDMUU7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMLDBFQUEwRTtBQUMxRTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsYUFBYTtBQUNiLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHNDQUFzQztBQUN0QyxvQ0FBb0M7QUFDcEM7QUFDQTtBQUNBLHdDQUF3QyxrQkFBa0I7QUFDMUQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHVEQUF1RDtBQUN2RDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esa0NBQWtDO0FBQ2xDO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSx3REFBd0QsY0FBYztBQUN0RTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsYUFBYTtBQUNiO0FBQ0E7QUFDQTtBQUNBO0FBQ0EseURBQXlELGNBQWM7QUFDdkU7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EseURBQXlELGNBQWM7QUFDdkU7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsYUFBYTtBQUNiO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsNkRBQTZELGNBQWM7QUFDM0U7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQSxzR0FBc0csMkRBQTJEO0FBQ2pLO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0Esc0dBQXNHLDJEQUEyRDtBQUNqSztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQSw4REFBOEQ7QUFDOUQsOERBQThEO0FBQzlELCtEQUErRDtBQUMvRCxxRUFBcUU7QUFDckUsK0RBQStEO0FBQy9EO0FBQ0E7QUFDQTtBQUNBLHFEQUFxRCxzQkFBc0IsdUJBQXVCO0FBQ2xHLHNEQUFzRCxzQkFBc0Isd0JBQXdCO0FBQ3BHLHFEQUFxRCxzQkFBc0IsdUJBQXVCO0FBQ2xHLHNEQUFzRCxzQkFBc0Isd0JBQXdCO0FBQ3BHO0FBQ0E7QUFDQSxrREFBa0QsNkNBQTZDO0FBQy9GO0FBQ0Esa0VBQWtFO0FBQ2xFO0FBQ0E7QUFDQTtBQUNBLCtEQUErRDtBQUMvRDtBQUNBLCtCQUErQiwrQkFBK0I7QUFDOUQsK0JBQStCLCtCQUErQjtBQUM5RCw2QkFBNkIsZ0NBQWdDO0FBQzdELDhCQUE4QiwwQkFBMEI7QUFDeEQsNkJBQTZCLG9CQUFvQjtBQUNqRCxrQ0FBa0M7QUFDbEM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQSw4REFBOEQ7QUFDOUQsOERBQThEO0FBQzlELHlEQUF5RDtBQUN6RCxpQ0FBaUM7QUFDakM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGtEQUFrRCx5QkFBeUI7QUFDM0U7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSzs7QUFFTDtBQUNBLG9DQUFvQztBQUNwQztBQUNBO0FBQ0Esd0NBQXdDLHFDQUFxQztBQUM3RSxTQUFTO0FBQ1Q7QUFDQTtBQUNBLGtDQUFrQztBQUNsQztBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQSxtREFBbUQsYUFBYTs7QUFFaEUsQ0FBQztBQUNEIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vY2xpZW50Ly4uL3NlcnZlci9ub2RlX21vZHVsZXMvc2lmdC9saWIvaW5kZXguanM/NmViZCJdLCJzb3VyY2VzQ29udGVudCI6WyIoZnVuY3Rpb24gKGdsb2JhbCwgZmFjdG9yeSkge1xuICAgIHR5cGVvZiBleHBvcnRzID09PSAnb2JqZWN0JyAmJiB0eXBlb2YgbW9kdWxlICE9PSAndW5kZWZpbmVkJyA/IGZhY3RvcnkoZXhwb3J0cykgOlxuICAgIHR5cGVvZiBkZWZpbmUgPT09ICdmdW5jdGlvbicgJiYgZGVmaW5lLmFtZCA/IGRlZmluZShbJ2V4cG9ydHMnXSwgZmFjdG9yeSkgOlxuICAgIChnbG9iYWwgPSBnbG9iYWwgfHwgc2VsZiwgZmFjdG9yeShnbG9iYWwuc2lmdCA9IHt9KSk7XG59KHRoaXMsIChmdW5jdGlvbiAoZXhwb3J0cykgeyAndXNlIHN0cmljdCc7XG5cbiAgICAvKiEgKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKipcclxuICAgIENvcHlyaWdodCAoYykgTWljcm9zb2Z0IENvcnBvcmF0aW9uLlxyXG5cclxuICAgIFBlcm1pc3Npb24gdG8gdXNlLCBjb3B5LCBtb2RpZnksIGFuZC9vciBkaXN0cmlidXRlIHRoaXMgc29mdHdhcmUgZm9yIGFueVxyXG4gICAgcHVycG9zZSB3aXRoIG9yIHdpdGhvdXQgZmVlIGlzIGhlcmVieSBncmFudGVkLlxyXG5cclxuICAgIFRIRSBTT0ZUV0FSRSBJUyBQUk9WSURFRCBcIkFTIElTXCIgQU5EIFRIRSBBVVRIT1IgRElTQ0xBSU1TIEFMTCBXQVJSQU5USUVTIFdJVEhcclxuICAgIFJFR0FSRCBUTyBUSElTIFNPRlRXQVJFIElOQ0xVRElORyBBTEwgSU1QTElFRCBXQVJSQU5USUVTIE9GIE1FUkNIQU5UQUJJTElUWVxyXG4gICAgQU5EIEZJVE5FU1MuIElOIE5PIEVWRU5UIFNIQUxMIFRIRSBBVVRIT1IgQkUgTElBQkxFIEZPUiBBTlkgU1BFQ0lBTCwgRElSRUNULFxyXG4gICAgSU5ESVJFQ1QsIE9SIENPTlNFUVVFTlRJQUwgREFNQUdFUyBPUiBBTlkgREFNQUdFUyBXSEFUU09FVkVSIFJFU1VMVElORyBGUk9NXHJcbiAgICBMT1NTIE9GIFVTRSwgREFUQSBPUiBQUk9GSVRTLCBXSEVUSEVSIElOIEFOIEFDVElPTiBPRiBDT05UUkFDVCwgTkVHTElHRU5DRSBPUlxyXG4gICAgT1RIRVIgVE9SVElPVVMgQUNUSU9OLCBBUklTSU5HIE9VVCBPRiBPUiBJTiBDT05ORUNUSU9OIFdJVEggVEhFIFVTRSBPUlxyXG4gICAgUEVSRk9STUFOQ0UgT0YgVEhJUyBTT0ZUV0FSRS5cclxuICAgICoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqICovXHJcbiAgICAvKiBnbG9iYWwgUmVmbGVjdCwgUHJvbWlzZSAqL1xyXG5cclxuICAgIHZhciBleHRlbmRTdGF0aWNzID0gZnVuY3Rpb24oZCwgYikge1xyXG4gICAgICAgIGV4dGVuZFN0YXRpY3MgPSBPYmplY3Quc2V0UHJvdG90eXBlT2YgfHxcclxuICAgICAgICAgICAgKHsgX19wcm90b19fOiBbXSB9IGluc3RhbmNlb2YgQXJyYXkgJiYgZnVuY3Rpb24gKGQsIGIpIHsgZC5fX3Byb3RvX18gPSBiOyB9KSB8fFxyXG4gICAgICAgICAgICBmdW5jdGlvbiAoZCwgYikgeyBmb3IgKHZhciBwIGluIGIpIGlmIChPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGwoYiwgcCkpIGRbcF0gPSBiW3BdOyB9O1xyXG4gICAgICAgIHJldHVybiBleHRlbmRTdGF0aWNzKGQsIGIpO1xyXG4gICAgfTtcclxuXHJcbiAgICBmdW5jdGlvbiBfX2V4dGVuZHMoZCwgYikge1xyXG4gICAgICAgIGlmICh0eXBlb2YgYiAhPT0gXCJmdW5jdGlvblwiICYmIGIgIT09IG51bGwpXHJcbiAgICAgICAgICAgIHRocm93IG5ldyBUeXBlRXJyb3IoXCJDbGFzcyBleHRlbmRzIHZhbHVlIFwiICsgU3RyaW5nKGIpICsgXCIgaXMgbm90IGEgY29uc3RydWN0b3Igb3IgbnVsbFwiKTtcclxuICAgICAgICBleHRlbmRTdGF0aWNzKGQsIGIpO1xyXG4gICAgICAgIGZ1bmN0aW9uIF9fKCkgeyB0aGlzLmNvbnN0cnVjdG9yID0gZDsgfVxyXG4gICAgICAgIGQucHJvdG90eXBlID0gYiA9PT0gbnVsbCA/IE9iamVjdC5jcmVhdGUoYikgOiAoX18ucHJvdG90eXBlID0gYi5wcm90b3R5cGUsIG5ldyBfXygpKTtcclxuICAgIH1cblxuICAgIHZhciB0eXBlQ2hlY2tlciA9IGZ1bmN0aW9uICh0eXBlKSB7XG4gICAgICAgIHZhciB0eXBlU3RyaW5nID0gXCJbb2JqZWN0IFwiICsgdHlwZSArIFwiXVwiO1xuICAgICAgICByZXR1cm4gZnVuY3Rpb24gKHZhbHVlKSB7XG4gICAgICAgICAgICByZXR1cm4gZ2V0Q2xhc3NOYW1lKHZhbHVlKSA9PT0gdHlwZVN0cmluZztcbiAgICAgICAgfTtcbiAgICB9O1xuICAgIHZhciBnZXRDbGFzc05hbWUgPSBmdW5jdGlvbiAodmFsdWUpIHsgcmV0dXJuIE9iamVjdC5wcm90b3R5cGUudG9TdHJpbmcuY2FsbCh2YWx1ZSk7IH07XG4gICAgdmFyIGNvbXBhcmFibGUgPSBmdW5jdGlvbiAodmFsdWUpIHtcbiAgICAgICAgaWYgKHZhbHVlIGluc3RhbmNlb2YgRGF0ZSkge1xuICAgICAgICAgICAgcmV0dXJuIHZhbHVlLmdldFRpbWUoKTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIGlmIChpc0FycmF5KHZhbHVlKSkge1xuICAgICAgICAgICAgcmV0dXJuIHZhbHVlLm1hcChjb21wYXJhYmxlKTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIGlmICh2YWx1ZSAmJiB0eXBlb2YgdmFsdWUudG9KU09OID09PSBcImZ1bmN0aW9uXCIpIHtcbiAgICAgICAgICAgIHJldHVybiB2YWx1ZS50b0pTT04oKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gdmFsdWU7XG4gICAgfTtcbiAgICB2YXIgaXNBcnJheSA9IHR5cGVDaGVja2VyKFwiQXJyYXlcIik7XG4gICAgdmFyIGlzT2JqZWN0ID0gdHlwZUNoZWNrZXIoXCJPYmplY3RcIik7XG4gICAgdmFyIGlzRnVuY3Rpb24gPSB0eXBlQ2hlY2tlcihcIkZ1bmN0aW9uXCIpO1xuICAgIHZhciBpc1ZhbmlsbGFPYmplY3QgPSBmdW5jdGlvbiAodmFsdWUpIHtcbiAgICAgICAgcmV0dXJuICh2YWx1ZSAmJlxuICAgICAgICAgICAgKHZhbHVlLmNvbnN0cnVjdG9yID09PSBPYmplY3QgfHxcbiAgICAgICAgICAgICAgICB2YWx1ZS5jb25zdHJ1Y3RvciA9PT0gQXJyYXkgfHxcbiAgICAgICAgICAgICAgICB2YWx1ZS5jb25zdHJ1Y3Rvci50b1N0cmluZygpID09PSBcImZ1bmN0aW9uIE9iamVjdCgpIHsgW25hdGl2ZSBjb2RlXSB9XCIgfHxcbiAgICAgICAgICAgICAgICB2YWx1ZS5jb25zdHJ1Y3Rvci50b1N0cmluZygpID09PSBcImZ1bmN0aW9uIEFycmF5KCkgeyBbbmF0aXZlIGNvZGVdIH1cIikgJiZcbiAgICAgICAgICAgICF2YWx1ZS50b0pTT04pO1xuICAgIH07XG4gICAgdmFyIGVxdWFscyA9IGZ1bmN0aW9uIChhLCBiKSB7XG4gICAgICAgIGlmIChhID09IG51bGwgJiYgYSA9PSBiKSB7XG4gICAgICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgICAgfVxuICAgICAgICBpZiAoYSA9PT0gYikge1xuICAgICAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKE9iamVjdC5wcm90b3R5cGUudG9TdHJpbmcuY2FsbChhKSAhPT0gT2JqZWN0LnByb3RvdHlwZS50b1N0cmluZy5jYWxsKGIpKSB7XG4gICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKGlzQXJyYXkoYSkpIHtcbiAgICAgICAgICAgIGlmIChhLmxlbmd0aCAhPT0gYi5sZW5ndGgpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBmb3IgKHZhciBpID0gMCwgbGVuZ3RoXzEgPSBhLmxlbmd0aDsgaSA8IGxlbmd0aF8xOyBpKyspIHtcbiAgICAgICAgICAgICAgICBpZiAoIWVxdWFscyhhW2ldLCBiW2ldKSlcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSBpZiAoaXNPYmplY3QoYSkpIHtcbiAgICAgICAgICAgIGlmIChPYmplY3Qua2V5cyhhKS5sZW5ndGggIT09IE9iamVjdC5rZXlzKGIpLmxlbmd0aCkge1xuICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGZvciAodmFyIGtleSBpbiBhKSB7XG4gICAgICAgICAgICAgICAgaWYgKCFlcXVhbHMoYVtrZXldLCBiW2tleV0pKVxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgfTtcblxuICAgIC8qKlxuICAgICAqIFdhbGtzIHRocm91Z2ggZWFjaCB2YWx1ZSBnaXZlbiB0aGUgY29udGV4dCAtIHVzZWQgZm9yIG5lc3RlZCBvcGVyYXRpb25zLiBFLmc6XG4gICAgICogeyBcInBlcnNvbi5hZGRyZXNzXCI6IHsgJGVxOiBcImJsYXJnXCIgfX1cbiAgICAgKi9cbiAgICB2YXIgd2Fsa0tleVBhdGhWYWx1ZXMgPSBmdW5jdGlvbiAoaXRlbSwga2V5UGF0aCwgbmV4dCwgZGVwdGgsIGtleSwgb3duZXIpIHtcbiAgICAgICAgdmFyIGN1cnJlbnRLZXkgPSBrZXlQYXRoW2RlcHRoXTtcbiAgICAgICAgLy8gaWYgYXJyYXksIHRoZW4gdHJ5IG1hdGNoaW5nLiBNaWdodCBmYWxsIHRocm91Z2ggZm9yIGNhc2VzIGxpa2U6XG4gICAgICAgIC8vIHsgJGVxOiBbMSwgMiwgM10gfSwgWyAxLCAyLCAzIF0uXG4gICAgICAgIGlmIChpc0FycmF5KGl0ZW0pICYmIGlzTmFOKE51bWJlcihjdXJyZW50S2V5KSkpIHtcbiAgICAgICAgICAgIGZvciAodmFyIGkgPSAwLCBsZW5ndGhfMSA9IGl0ZW0ubGVuZ3RoOyBpIDwgbGVuZ3RoXzE7IGkrKykge1xuICAgICAgICAgICAgICAgIC8vIGlmIEZBTFNFIGlzIHJldHVybmVkLCB0aGVuIHRlcm1pbmF0ZSB3YWxrZXIuIEZvciBvcGVyYXRpb25zLCB0aGlzIHNpbXBseVxuICAgICAgICAgICAgICAgIC8vIG1lYW5zIHRoYXQgdGhlIHNlYXJjaCBjcml0ZXJhIHdhcyBtZXQuXG4gICAgICAgICAgICAgICAgaWYgKCF3YWxrS2V5UGF0aFZhbHVlcyhpdGVtW2ldLCBrZXlQYXRoLCBuZXh0LCBkZXB0aCwgaSwgaXRlbSkpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBpZiAoZGVwdGggPT09IGtleVBhdGgubGVuZ3RoIHx8IGl0ZW0gPT0gbnVsbCkge1xuICAgICAgICAgICAgcmV0dXJuIG5leHQoaXRlbSwga2V5LCBvd25lciwgZGVwdGggPT09IDApO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiB3YWxrS2V5UGF0aFZhbHVlcyhpdGVtW2N1cnJlbnRLZXldLCBrZXlQYXRoLCBuZXh0LCBkZXB0aCArIDEsIGN1cnJlbnRLZXksIGl0ZW0pO1xuICAgIH07XG4gICAgdmFyIEJhc2VPcGVyYXRpb24gPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoKSB7XG4gICAgICAgIGZ1bmN0aW9uIEJhc2VPcGVyYXRpb24ocGFyYW1zLCBvd25lcnlRdWVyeSwgb3B0aW9ucywgbmFtZSkge1xuICAgICAgICAgICAgdGhpcy5wYXJhbXMgPSBwYXJhbXM7XG4gICAgICAgICAgICB0aGlzLm93bmVyeVF1ZXJ5ID0gb3duZXJ5UXVlcnk7XG4gICAgICAgICAgICB0aGlzLm9wdGlvbnMgPSBvcHRpb25zO1xuICAgICAgICAgICAgdGhpcy5uYW1lID0gbmFtZTtcbiAgICAgICAgICAgIHRoaXMuaW5pdCgpO1xuICAgICAgICB9XG4gICAgICAgIEJhc2VPcGVyYXRpb24ucHJvdG90eXBlLmluaXQgPSBmdW5jdGlvbiAoKSB7IH07XG4gICAgICAgIEJhc2VPcGVyYXRpb24ucHJvdG90eXBlLnJlc2V0ID0gZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgdGhpcy5kb25lID0gZmFsc2U7XG4gICAgICAgICAgICB0aGlzLmtlZXAgPSBmYWxzZTtcbiAgICAgICAgfTtcbiAgICAgICAgcmV0dXJuIEJhc2VPcGVyYXRpb247XG4gICAgfSgpKTtcbiAgICB2YXIgR3JvdXBPcGVyYXRpb24gPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoX3N1cGVyKSB7XG4gICAgICAgIF9fZXh0ZW5kcyhHcm91cE9wZXJhdGlvbiwgX3N1cGVyKTtcbiAgICAgICAgZnVuY3Rpb24gR3JvdXBPcGVyYXRpb24ocGFyYW1zLCBvd25lcnlRdWVyeSwgb3B0aW9ucywgY2hpbGRyZW4pIHtcbiAgICAgICAgICAgIHZhciBfdGhpcyA9IF9zdXBlci5jYWxsKHRoaXMsIHBhcmFtcywgb3duZXJ5UXVlcnksIG9wdGlvbnMpIHx8IHRoaXM7XG4gICAgICAgICAgICBfdGhpcy5jaGlsZHJlbiA9IGNoaWxkcmVuO1xuICAgICAgICAgICAgcmV0dXJuIF90aGlzO1xuICAgICAgICB9XG4gICAgICAgIC8qKlxuICAgICAgICAgKi9cbiAgICAgICAgR3JvdXBPcGVyYXRpb24ucHJvdG90eXBlLnJlc2V0ID0gZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgdGhpcy5rZWVwID0gZmFsc2U7XG4gICAgICAgICAgICB0aGlzLmRvbmUgPSBmYWxzZTtcbiAgICAgICAgICAgIGZvciAodmFyIGkgPSAwLCBsZW5ndGhfMiA9IHRoaXMuY2hpbGRyZW4ubGVuZ3RoOyBpIDwgbGVuZ3RoXzI7IGkrKykge1xuICAgICAgICAgICAgICAgIHRoaXMuY2hpbGRyZW5baV0ucmVzZXQoKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfTtcbiAgICAgICAgLyoqXG4gICAgICAgICAqL1xuICAgICAgICBHcm91cE9wZXJhdGlvbi5wcm90b3R5cGUuY2hpbGRyZW5OZXh0ID0gZnVuY3Rpb24gKGl0ZW0sIGtleSwgb3duZXIsIHJvb3QpIHtcbiAgICAgICAgICAgIHZhciBkb25lID0gdHJ1ZTtcbiAgICAgICAgICAgIHZhciBrZWVwID0gdHJ1ZTtcbiAgICAgICAgICAgIGZvciAodmFyIGkgPSAwLCBsZW5ndGhfMyA9IHRoaXMuY2hpbGRyZW4ubGVuZ3RoOyBpIDwgbGVuZ3RoXzM7IGkrKykge1xuICAgICAgICAgICAgICAgIHZhciBjaGlsZE9wZXJhdGlvbiA9IHRoaXMuY2hpbGRyZW5baV07XG4gICAgICAgICAgICAgICAgaWYgKCFjaGlsZE9wZXJhdGlvbi5kb25lKSB7XG4gICAgICAgICAgICAgICAgICAgIGNoaWxkT3BlcmF0aW9uLm5leHQoaXRlbSwga2V5LCBvd25lciwgcm9vdCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGlmICghY2hpbGRPcGVyYXRpb24ua2VlcCkge1xuICAgICAgICAgICAgICAgICAgICBrZWVwID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGlmIChjaGlsZE9wZXJhdGlvbi5kb25lKSB7XG4gICAgICAgICAgICAgICAgICAgIGlmICghY2hpbGRPcGVyYXRpb24ua2VlcCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIGRvbmUgPSBmYWxzZTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB0aGlzLmRvbmUgPSBkb25lO1xuICAgICAgICAgICAgdGhpcy5rZWVwID0ga2VlcDtcbiAgICAgICAgfTtcbiAgICAgICAgcmV0dXJuIEdyb3VwT3BlcmF0aW9uO1xuICAgIH0oQmFzZU9wZXJhdGlvbikpO1xuICAgIHZhciBOYW1lZEdyb3VwT3BlcmF0aW9uID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKF9zdXBlcikge1xuICAgICAgICBfX2V4dGVuZHMoTmFtZWRHcm91cE9wZXJhdGlvbiwgX3N1cGVyKTtcbiAgICAgICAgZnVuY3Rpb24gTmFtZWRHcm91cE9wZXJhdGlvbihwYXJhbXMsIG93bmVyeVF1ZXJ5LCBvcHRpb25zLCBjaGlsZHJlbiwgbmFtZSkge1xuICAgICAgICAgICAgdmFyIF90aGlzID0gX3N1cGVyLmNhbGwodGhpcywgcGFyYW1zLCBvd25lcnlRdWVyeSwgb3B0aW9ucywgY2hpbGRyZW4pIHx8IHRoaXM7XG4gICAgICAgICAgICBfdGhpcy5uYW1lID0gbmFtZTtcbiAgICAgICAgICAgIHJldHVybiBfdGhpcztcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gTmFtZWRHcm91cE9wZXJhdGlvbjtcbiAgICB9KEdyb3VwT3BlcmF0aW9uKSk7XG4gICAgdmFyIFF1ZXJ5T3BlcmF0aW9uID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKF9zdXBlcikge1xuICAgICAgICBfX2V4dGVuZHMoUXVlcnlPcGVyYXRpb24sIF9zdXBlcik7XG4gICAgICAgIGZ1bmN0aW9uIFF1ZXJ5T3BlcmF0aW9uKCkge1xuICAgICAgICAgICAgdmFyIF90aGlzID0gX3N1cGVyICE9PSBudWxsICYmIF9zdXBlci5hcHBseSh0aGlzLCBhcmd1bWVudHMpIHx8IHRoaXM7XG4gICAgICAgICAgICBfdGhpcy5wcm9wb3AgPSB0cnVlO1xuICAgICAgICAgICAgcmV0dXJuIF90aGlzO1xuICAgICAgICB9XG4gICAgICAgIC8qKlxuICAgICAgICAgKi9cbiAgICAgICAgUXVlcnlPcGVyYXRpb24ucHJvdG90eXBlLm5leHQgPSBmdW5jdGlvbiAoaXRlbSwga2V5LCBwYXJlbnQsIHJvb3QpIHtcbiAgICAgICAgICAgIHRoaXMuY2hpbGRyZW5OZXh0KGl0ZW0sIGtleSwgcGFyZW50LCByb290KTtcbiAgICAgICAgfTtcbiAgICAgICAgcmV0dXJuIFF1ZXJ5T3BlcmF0aW9uO1xuICAgIH0oR3JvdXBPcGVyYXRpb24pKTtcbiAgICB2YXIgTmVzdGVkT3BlcmF0aW9uID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKF9zdXBlcikge1xuICAgICAgICBfX2V4dGVuZHMoTmVzdGVkT3BlcmF0aW9uLCBfc3VwZXIpO1xuICAgICAgICBmdW5jdGlvbiBOZXN0ZWRPcGVyYXRpb24oa2V5UGF0aCwgcGFyYW1zLCBvd25lcnlRdWVyeSwgb3B0aW9ucywgY2hpbGRyZW4pIHtcbiAgICAgICAgICAgIHZhciBfdGhpcyA9IF9zdXBlci5jYWxsKHRoaXMsIHBhcmFtcywgb3duZXJ5UXVlcnksIG9wdGlvbnMsIGNoaWxkcmVuKSB8fCB0aGlzO1xuICAgICAgICAgICAgX3RoaXMua2V5UGF0aCA9IGtleVBhdGg7XG4gICAgICAgICAgICBfdGhpcy5wcm9wb3AgPSB0cnVlO1xuICAgICAgICAgICAgLyoqXG4gICAgICAgICAgICAgKi9cbiAgICAgICAgICAgIF90aGlzLl9uZXh0TmVzdGVkVmFsdWUgPSBmdW5jdGlvbiAodmFsdWUsIGtleSwgb3duZXIsIHJvb3QpIHtcbiAgICAgICAgICAgICAgICBfdGhpcy5jaGlsZHJlbk5leHQodmFsdWUsIGtleSwgb3duZXIsIHJvb3QpO1xuICAgICAgICAgICAgICAgIHJldHVybiAhX3RoaXMuZG9uZTtcbiAgICAgICAgICAgIH07XG4gICAgICAgICAgICByZXR1cm4gX3RoaXM7XG4gICAgICAgIH1cbiAgICAgICAgLyoqXG4gICAgICAgICAqL1xuICAgICAgICBOZXN0ZWRPcGVyYXRpb24ucHJvdG90eXBlLm5leHQgPSBmdW5jdGlvbiAoaXRlbSwga2V5LCBwYXJlbnQpIHtcbiAgICAgICAgICAgIHdhbGtLZXlQYXRoVmFsdWVzKGl0ZW0sIHRoaXMua2V5UGF0aCwgdGhpcy5fbmV4dE5lc3RlZFZhbHVlLCAwLCBrZXksIHBhcmVudCk7XG4gICAgICAgIH07XG4gICAgICAgIHJldHVybiBOZXN0ZWRPcGVyYXRpb247XG4gICAgfShHcm91cE9wZXJhdGlvbikpO1xuICAgIHZhciBjcmVhdGVUZXN0ZXIgPSBmdW5jdGlvbiAoYSwgY29tcGFyZSkge1xuICAgICAgICBpZiAoYSBpbnN0YW5jZW9mIEZ1bmN0aW9uKSB7XG4gICAgICAgICAgICByZXR1cm4gYTtcbiAgICAgICAgfVxuICAgICAgICBpZiAoYSBpbnN0YW5jZW9mIFJlZ0V4cCkge1xuICAgICAgICAgICAgcmV0dXJuIGZ1bmN0aW9uIChiKSB7XG4gICAgICAgICAgICAgICAgdmFyIHJlc3VsdCA9IHR5cGVvZiBiID09PSBcInN0cmluZ1wiICYmIGEudGVzdChiKTtcbiAgICAgICAgICAgICAgICBhLmxhc3RJbmRleCA9IDA7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHJlc3VsdDtcbiAgICAgICAgICAgIH07XG4gICAgICAgIH1cbiAgICAgICAgdmFyIGNvbXBhcmFibGVBID0gY29tcGFyYWJsZShhKTtcbiAgICAgICAgcmV0dXJuIGZ1bmN0aW9uIChiKSB7IHJldHVybiBjb21wYXJlKGNvbXBhcmFibGVBLCBjb21wYXJhYmxlKGIpKTsgfTtcbiAgICB9O1xuICAgIHZhciBFcXVhbHNPcGVyYXRpb24gPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoX3N1cGVyKSB7XG4gICAgICAgIF9fZXh0ZW5kcyhFcXVhbHNPcGVyYXRpb24sIF9zdXBlcik7XG4gICAgICAgIGZ1bmN0aW9uIEVxdWFsc09wZXJhdGlvbigpIHtcbiAgICAgICAgICAgIHZhciBfdGhpcyA9IF9zdXBlciAhPT0gbnVsbCAmJiBfc3VwZXIuYXBwbHkodGhpcywgYXJndW1lbnRzKSB8fCB0aGlzO1xuICAgICAgICAgICAgX3RoaXMucHJvcG9wID0gdHJ1ZTtcbiAgICAgICAgICAgIHJldHVybiBfdGhpcztcbiAgICAgICAgfVxuICAgICAgICBFcXVhbHNPcGVyYXRpb24ucHJvdG90eXBlLmluaXQgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICB0aGlzLl90ZXN0ID0gY3JlYXRlVGVzdGVyKHRoaXMucGFyYW1zLCB0aGlzLm9wdGlvbnMuY29tcGFyZSk7XG4gICAgICAgIH07XG4gICAgICAgIEVxdWFsc09wZXJhdGlvbi5wcm90b3R5cGUubmV4dCA9IGZ1bmN0aW9uIChpdGVtLCBrZXksIHBhcmVudCkge1xuICAgICAgICAgICAgaWYgKCFBcnJheS5pc0FycmF5KHBhcmVudCkgfHwgcGFyZW50Lmhhc093blByb3BlcnR5KGtleSkpIHtcbiAgICAgICAgICAgICAgICBpZiAodGhpcy5fdGVzdChpdGVtLCBrZXksIHBhcmVudCkpIHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5kb25lID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5rZWVwID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH07XG4gICAgICAgIHJldHVybiBFcXVhbHNPcGVyYXRpb247XG4gICAgfShCYXNlT3BlcmF0aW9uKSk7XG4gICAgdmFyIGNyZWF0ZUVxdWFsc09wZXJhdGlvbiA9IGZ1bmN0aW9uIChwYXJhbXMsIG93bmVyeVF1ZXJ5LCBvcHRpb25zKSB7IHJldHVybiBuZXcgRXF1YWxzT3BlcmF0aW9uKHBhcmFtcywgb3duZXJ5UXVlcnksIG9wdGlvbnMpOyB9O1xuICAgIHZhciBOb3BlT3BlcmF0aW9uID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKF9zdXBlcikge1xuICAgICAgICBfX2V4dGVuZHMoTm9wZU9wZXJhdGlvbiwgX3N1cGVyKTtcbiAgICAgICAgZnVuY3Rpb24gTm9wZU9wZXJhdGlvbigpIHtcbiAgICAgICAgICAgIHZhciBfdGhpcyA9IF9zdXBlciAhPT0gbnVsbCAmJiBfc3VwZXIuYXBwbHkodGhpcywgYXJndW1lbnRzKSB8fCB0aGlzO1xuICAgICAgICAgICAgX3RoaXMucHJvcG9wID0gdHJ1ZTtcbiAgICAgICAgICAgIHJldHVybiBfdGhpcztcbiAgICAgICAgfVxuICAgICAgICBOb3BlT3BlcmF0aW9uLnByb3RvdHlwZS5uZXh0ID0gZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgdGhpcy5kb25lID0gdHJ1ZTtcbiAgICAgICAgICAgIHRoaXMua2VlcCA9IGZhbHNlO1xuICAgICAgICB9O1xuICAgICAgICByZXR1cm4gTm9wZU9wZXJhdGlvbjtcbiAgICB9KEJhc2VPcGVyYXRpb24pKTtcbiAgICB2YXIgbnVtZXJpY2FsT3BlcmF0aW9uQ3JlYXRvciA9IGZ1bmN0aW9uIChjcmVhdGVOdW1lcmljYWxPcGVyYXRpb24pIHsgcmV0dXJuIGZ1bmN0aW9uIChwYXJhbXMsIG93bmVyeVF1ZXJ5LCBvcHRpb25zLCBuYW1lKSB7XG4gICAgICAgIGlmIChwYXJhbXMgPT0gbnVsbCkge1xuICAgICAgICAgICAgcmV0dXJuIG5ldyBOb3BlT3BlcmF0aW9uKHBhcmFtcywgb3duZXJ5UXVlcnksIG9wdGlvbnMsIG5hbWUpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBjcmVhdGVOdW1lcmljYWxPcGVyYXRpb24ocGFyYW1zLCBvd25lcnlRdWVyeSwgb3B0aW9ucywgbmFtZSk7XG4gICAgfTsgfTtcbiAgICB2YXIgbnVtZXJpY2FsT3BlcmF0aW9uID0gZnVuY3Rpb24gKGNyZWF0ZVRlc3Rlcikge1xuICAgICAgICByZXR1cm4gbnVtZXJpY2FsT3BlcmF0aW9uQ3JlYXRvcihmdW5jdGlvbiAocGFyYW1zLCBvd25lcnlRdWVyeSwgb3B0aW9ucywgbmFtZSkge1xuICAgICAgICAgICAgdmFyIHR5cGVvZlBhcmFtcyA9IHR5cGVvZiBjb21wYXJhYmxlKHBhcmFtcyk7XG4gICAgICAgICAgICB2YXIgdGVzdCA9IGNyZWF0ZVRlc3RlcihwYXJhbXMpO1xuICAgICAgICAgICAgcmV0dXJuIG5ldyBFcXVhbHNPcGVyYXRpb24oZnVuY3Rpb24gKGIpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gdHlwZW9mIGNvbXBhcmFibGUoYikgPT09IHR5cGVvZlBhcmFtcyAmJiB0ZXN0KGIpO1xuICAgICAgICAgICAgfSwgb3duZXJ5UXVlcnksIG9wdGlvbnMsIG5hbWUpO1xuICAgICAgICB9KTtcbiAgICB9O1xuICAgIHZhciBjcmVhdGVOYW1lZE9wZXJhdGlvbiA9IGZ1bmN0aW9uIChuYW1lLCBwYXJhbXMsIHBhcmVudFF1ZXJ5LCBvcHRpb25zKSB7XG4gICAgICAgIHZhciBvcGVyYXRpb25DcmVhdG9yID0gb3B0aW9ucy5vcGVyYXRpb25zW25hbWVdO1xuICAgICAgICBpZiAoIW9wZXJhdGlvbkNyZWF0b3IpIHtcbiAgICAgICAgICAgIHRocm93VW5zdXBwb3J0ZWRPcGVyYXRpb24obmFtZSk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIG9wZXJhdGlvbkNyZWF0b3IocGFyYW1zLCBwYXJlbnRRdWVyeSwgb3B0aW9ucywgbmFtZSk7XG4gICAgfTtcbiAgICB2YXIgdGhyb3dVbnN1cHBvcnRlZE9wZXJhdGlvbiA9IGZ1bmN0aW9uIChuYW1lKSB7XG4gICAgICAgIHRocm93IG5ldyBFcnJvcihcIlVuc3VwcG9ydGVkIG9wZXJhdGlvbjogXCIgKyBuYW1lKTtcbiAgICB9O1xuICAgIHZhciBjb250YWluc09wZXJhdGlvbiA9IGZ1bmN0aW9uIChxdWVyeSwgb3B0aW9ucykge1xuICAgICAgICBmb3IgKHZhciBrZXkgaW4gcXVlcnkpIHtcbiAgICAgICAgICAgIGlmIChvcHRpb25zLm9wZXJhdGlvbnMuaGFzT3duUHJvcGVydHkoa2V5KSB8fCBrZXkuY2hhckF0KDApID09PSBcIiRcIilcbiAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgfTtcbiAgICB2YXIgY3JlYXRlTmVzdGVkT3BlcmF0aW9uID0gZnVuY3Rpb24gKGtleVBhdGgsIG5lc3RlZFF1ZXJ5LCBwYXJlbnRLZXksIG93bmVyeVF1ZXJ5LCBvcHRpb25zKSB7XG4gICAgICAgIGlmIChjb250YWluc09wZXJhdGlvbihuZXN0ZWRRdWVyeSwgb3B0aW9ucykpIHtcbiAgICAgICAgICAgIHZhciBfYSA9IGNyZWF0ZVF1ZXJ5T3BlcmF0aW9ucyhuZXN0ZWRRdWVyeSwgcGFyZW50S2V5LCBvcHRpb25zKSwgc2VsZk9wZXJhdGlvbnMgPSBfYVswXSwgbmVzdGVkT3BlcmF0aW9ucyA9IF9hWzFdO1xuICAgICAgICAgICAgaWYgKG5lc3RlZE9wZXJhdGlvbnMubGVuZ3RoKSB7XG4gICAgICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKFwiUHJvcGVydHkgcXVlcmllcyBtdXN0IGNvbnRhaW4gb25seSBvcGVyYXRpb25zLCBvciBleGFjdCBvYmplY3RzLlwiKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiBuZXcgTmVzdGVkT3BlcmF0aW9uKGtleVBhdGgsIG5lc3RlZFF1ZXJ5LCBvd25lcnlRdWVyeSwgb3B0aW9ucywgc2VsZk9wZXJhdGlvbnMpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBuZXcgTmVzdGVkT3BlcmF0aW9uKGtleVBhdGgsIG5lc3RlZFF1ZXJ5LCBvd25lcnlRdWVyeSwgb3B0aW9ucywgW1xuICAgICAgICAgICAgbmV3IEVxdWFsc09wZXJhdGlvbihuZXN0ZWRRdWVyeSwgb3duZXJ5UXVlcnksIG9wdGlvbnMpXG4gICAgICAgIF0pO1xuICAgIH07XG4gICAgdmFyIGNyZWF0ZVF1ZXJ5T3BlcmF0aW9uID0gZnVuY3Rpb24gKHF1ZXJ5LCBvd25lcnlRdWVyeSwgX2EpIHtcbiAgICAgICAgaWYgKG93bmVyeVF1ZXJ5ID09PSB2b2lkIDApIHsgb3duZXJ5UXVlcnkgPSBudWxsOyB9XG4gICAgICAgIHZhciBfYiA9IF9hID09PSB2b2lkIDAgPyB7fSA6IF9hLCBjb21wYXJlID0gX2IuY29tcGFyZSwgb3BlcmF0aW9ucyA9IF9iLm9wZXJhdGlvbnM7XG4gICAgICAgIHZhciBvcHRpb25zID0ge1xuICAgICAgICAgICAgY29tcGFyZTogY29tcGFyZSB8fCBlcXVhbHMsXG4gICAgICAgICAgICBvcGVyYXRpb25zOiBPYmplY3QuYXNzaWduKHt9LCBvcGVyYXRpb25zIHx8IHt9KVxuICAgICAgICB9O1xuICAgICAgICB2YXIgX2MgPSBjcmVhdGVRdWVyeU9wZXJhdGlvbnMocXVlcnksIG51bGwsIG9wdGlvbnMpLCBzZWxmT3BlcmF0aW9ucyA9IF9jWzBdLCBuZXN0ZWRPcGVyYXRpb25zID0gX2NbMV07XG4gICAgICAgIHZhciBvcHMgPSBbXTtcbiAgICAgICAgaWYgKHNlbGZPcGVyYXRpb25zLmxlbmd0aCkge1xuICAgICAgICAgICAgb3BzLnB1c2gobmV3IE5lc3RlZE9wZXJhdGlvbihbXSwgcXVlcnksIG93bmVyeVF1ZXJ5LCBvcHRpb25zLCBzZWxmT3BlcmF0aW9ucykpO1xuICAgICAgICB9XG4gICAgICAgIG9wcy5wdXNoLmFwcGx5KG9wcywgbmVzdGVkT3BlcmF0aW9ucyk7XG4gICAgICAgIGlmIChvcHMubGVuZ3RoID09PSAxKSB7XG4gICAgICAgICAgICByZXR1cm4gb3BzWzBdO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBuZXcgUXVlcnlPcGVyYXRpb24ocXVlcnksIG93bmVyeVF1ZXJ5LCBvcHRpb25zLCBvcHMpO1xuICAgIH07XG4gICAgdmFyIGNyZWF0ZVF1ZXJ5T3BlcmF0aW9ucyA9IGZ1bmN0aW9uIChxdWVyeSwgcGFyZW50S2V5LCBvcHRpb25zKSB7XG4gICAgICAgIHZhciBzZWxmT3BlcmF0aW9ucyA9IFtdO1xuICAgICAgICB2YXIgbmVzdGVkT3BlcmF0aW9ucyA9IFtdO1xuICAgICAgICBpZiAoIWlzVmFuaWxsYU9iamVjdChxdWVyeSkpIHtcbiAgICAgICAgICAgIHNlbGZPcGVyYXRpb25zLnB1c2gobmV3IEVxdWFsc09wZXJhdGlvbihxdWVyeSwgcXVlcnksIG9wdGlvbnMpKTtcbiAgICAgICAgICAgIHJldHVybiBbc2VsZk9wZXJhdGlvbnMsIG5lc3RlZE9wZXJhdGlvbnNdO1xuICAgICAgICB9XG4gICAgICAgIGZvciAodmFyIGtleSBpbiBxdWVyeSkge1xuICAgICAgICAgICAgaWYgKG9wdGlvbnMub3BlcmF0aW9ucy5oYXNPd25Qcm9wZXJ0eShrZXkpKSB7XG4gICAgICAgICAgICAgICAgdmFyIG9wID0gY3JlYXRlTmFtZWRPcGVyYXRpb24oa2V5LCBxdWVyeVtrZXldLCBxdWVyeSwgb3B0aW9ucyk7XG4gICAgICAgICAgICAgICAgaWYgKG9wKSB7XG4gICAgICAgICAgICAgICAgICAgIGlmICghb3AucHJvcG9wICYmIHBhcmVudEtleSAmJiAhb3B0aW9ucy5vcGVyYXRpb25zW3BhcmVudEtleV0pIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihcIk1hbGZvcm1lZCBxdWVyeS4gXCIgKyBrZXkgKyBcIiBjYW5ub3QgYmUgbWF0Y2hlZCBhZ2FpbnN0IHByb3BlcnR5LlwiKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAvLyBwcm9iYWJseSBqdXN0IGEgZmxhZyBmb3IgYW5vdGhlciBvcGVyYXRpb24gKGxpa2UgJG9wdGlvbnMpXG4gICAgICAgICAgICAgICAgaWYgKG9wICE9IG51bGwpIHtcbiAgICAgICAgICAgICAgICAgICAgc2VsZk9wZXJhdGlvbnMucHVzaChvcCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSBpZiAoa2V5LmNoYXJBdCgwKSA9PT0gXCIkXCIpIHtcbiAgICAgICAgICAgICAgICB0aHJvd1Vuc3VwcG9ydGVkT3BlcmF0aW9uKGtleSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICBuZXN0ZWRPcGVyYXRpb25zLnB1c2goY3JlYXRlTmVzdGVkT3BlcmF0aW9uKGtleS5zcGxpdChcIi5cIiksIHF1ZXJ5W2tleV0sIGtleSwgcXVlcnksIG9wdGlvbnMpKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gW3NlbGZPcGVyYXRpb25zLCBuZXN0ZWRPcGVyYXRpb25zXTtcbiAgICB9O1xuICAgIHZhciBjcmVhdGVPcGVyYXRpb25UZXN0ZXIgPSBmdW5jdGlvbiAob3BlcmF0aW9uKSB7IHJldHVybiBmdW5jdGlvbiAoaXRlbSwga2V5LCBvd25lcikge1xuICAgICAgICBvcGVyYXRpb24ucmVzZXQoKTtcbiAgICAgICAgb3BlcmF0aW9uLm5leHQoaXRlbSwga2V5LCBvd25lcik7XG4gICAgICAgIHJldHVybiBvcGVyYXRpb24ua2VlcDtcbiAgICB9OyB9O1xuICAgIHZhciBjcmVhdGVRdWVyeVRlc3RlciA9IGZ1bmN0aW9uIChxdWVyeSwgb3B0aW9ucykge1xuICAgICAgICBpZiAob3B0aW9ucyA9PT0gdm9pZCAwKSB7IG9wdGlvbnMgPSB7fTsgfVxuICAgICAgICByZXR1cm4gY3JlYXRlT3BlcmF0aW9uVGVzdGVyKGNyZWF0ZVF1ZXJ5T3BlcmF0aW9uKHF1ZXJ5LCBudWxsLCBvcHRpb25zKSk7XG4gICAgfTtcblxuICAgIHZhciAkTmUgPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoX3N1cGVyKSB7XG4gICAgICAgIF9fZXh0ZW5kcygkTmUsIF9zdXBlcik7XG4gICAgICAgIGZ1bmN0aW9uICROZSgpIHtcbiAgICAgICAgICAgIHZhciBfdGhpcyA9IF9zdXBlciAhPT0gbnVsbCAmJiBfc3VwZXIuYXBwbHkodGhpcywgYXJndW1lbnRzKSB8fCB0aGlzO1xuICAgICAgICAgICAgX3RoaXMucHJvcG9wID0gdHJ1ZTtcbiAgICAgICAgICAgIHJldHVybiBfdGhpcztcbiAgICAgICAgfVxuICAgICAgICAkTmUucHJvdG90eXBlLmluaXQgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICB0aGlzLl90ZXN0ID0gY3JlYXRlVGVzdGVyKHRoaXMucGFyYW1zLCB0aGlzLm9wdGlvbnMuY29tcGFyZSk7XG4gICAgICAgIH07XG4gICAgICAgICROZS5wcm90b3R5cGUucmVzZXQgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICBfc3VwZXIucHJvdG90eXBlLnJlc2V0LmNhbGwodGhpcyk7XG4gICAgICAgICAgICB0aGlzLmtlZXAgPSB0cnVlO1xuICAgICAgICB9O1xuICAgICAgICAkTmUucHJvdG90eXBlLm5leHQgPSBmdW5jdGlvbiAoaXRlbSkge1xuICAgICAgICAgICAgaWYgKHRoaXMuX3Rlc3QoaXRlbSkpIHtcbiAgICAgICAgICAgICAgICB0aGlzLmRvbmUgPSB0cnVlO1xuICAgICAgICAgICAgICAgIHRoaXMua2VlcCA9IGZhbHNlO1xuICAgICAgICAgICAgfVxuICAgICAgICB9O1xuICAgICAgICByZXR1cm4gJE5lO1xuICAgIH0oQmFzZU9wZXJhdGlvbikpO1xuICAgIC8vIGh0dHBzOi8vZG9jcy5tb25nb2RiLmNvbS9tYW51YWwvcmVmZXJlbmNlL29wZXJhdG9yL3F1ZXJ5L2VsZW1NYXRjaC9cbiAgICB2YXIgJEVsZW1NYXRjaCA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uIChfc3VwZXIpIHtcbiAgICAgICAgX19leHRlbmRzKCRFbGVtTWF0Y2gsIF9zdXBlcik7XG4gICAgICAgIGZ1bmN0aW9uICRFbGVtTWF0Y2goKSB7XG4gICAgICAgICAgICB2YXIgX3RoaXMgPSBfc3VwZXIgIT09IG51bGwgJiYgX3N1cGVyLmFwcGx5KHRoaXMsIGFyZ3VtZW50cykgfHwgdGhpcztcbiAgICAgICAgICAgIF90aGlzLnByb3BvcCA9IHRydWU7XG4gICAgICAgICAgICByZXR1cm4gX3RoaXM7XG4gICAgICAgIH1cbiAgICAgICAgJEVsZW1NYXRjaC5wcm90b3R5cGUuaW5pdCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIGlmICghdGhpcy5wYXJhbXMgfHwgdHlwZW9mIHRoaXMucGFyYW1zICE9PSBcIm9iamVjdFwiKSB7XG4gICAgICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKFwiTWFsZm9ybWVkIHF1ZXJ5LiAkZWxlbU1hdGNoIG11c3QgYnkgYW4gb2JqZWN0LlwiKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHRoaXMuX3F1ZXJ5T3BlcmF0aW9uID0gY3JlYXRlUXVlcnlPcGVyYXRpb24odGhpcy5wYXJhbXMsIHRoaXMub3duZXJ5UXVlcnksIHRoaXMub3B0aW9ucyk7XG4gICAgICAgIH07XG4gICAgICAgICRFbGVtTWF0Y2gucHJvdG90eXBlLnJlc2V0ID0gZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgX3N1cGVyLnByb3RvdHlwZS5yZXNldC5jYWxsKHRoaXMpO1xuICAgICAgICAgICAgdGhpcy5fcXVlcnlPcGVyYXRpb24ucmVzZXQoKTtcbiAgICAgICAgfTtcbiAgICAgICAgJEVsZW1NYXRjaC5wcm90b3R5cGUubmV4dCA9IGZ1bmN0aW9uIChpdGVtKSB7XG4gICAgICAgICAgICBpZiAoaXNBcnJheShpdGVtKSkge1xuICAgICAgICAgICAgICAgIGZvciAodmFyIGkgPSAwLCBsZW5ndGhfMSA9IGl0ZW0ubGVuZ3RoOyBpIDwgbGVuZ3RoXzE7IGkrKykge1xuICAgICAgICAgICAgICAgICAgICAvLyByZXNldCBxdWVyeSBvcGVyYXRpb24gc2luY2UgaXRlbSBiZWluZyB0ZXN0ZWQgbmVlZHMgdG8gcGFzcyBfYWxsXyBxdWVyeVxuICAgICAgICAgICAgICAgICAgICAvLyBvcGVyYXRpb25zIGZvciBpdCB0byBiZSBhIHN1Y2Nlc3NcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5fcXVlcnlPcGVyYXRpb24ucmVzZXQoKTtcbiAgICAgICAgICAgICAgICAgICAgdmFyIGNoaWxkID0gaXRlbVtpXTtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5fcXVlcnlPcGVyYXRpb24ubmV4dChjaGlsZCwgaSwgaXRlbSwgZmFsc2UpO1xuICAgICAgICAgICAgICAgICAgICB0aGlzLmtlZXAgPSB0aGlzLmtlZXAgfHwgdGhpcy5fcXVlcnlPcGVyYXRpb24ua2VlcDtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgdGhpcy5kb25lID0gdHJ1ZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgIHRoaXMuZG9uZSA9IGZhbHNlO1xuICAgICAgICAgICAgICAgIHRoaXMua2VlcCA9IGZhbHNlO1xuICAgICAgICAgICAgfVxuICAgICAgICB9O1xuICAgICAgICByZXR1cm4gJEVsZW1NYXRjaDtcbiAgICB9KEJhc2VPcGVyYXRpb24pKTtcbiAgICB2YXIgJE5vdCA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uIChfc3VwZXIpIHtcbiAgICAgICAgX19leHRlbmRzKCROb3QsIF9zdXBlcik7XG4gICAgICAgIGZ1bmN0aW9uICROb3QoKSB7XG4gICAgICAgICAgICB2YXIgX3RoaXMgPSBfc3VwZXIgIT09IG51bGwgJiYgX3N1cGVyLmFwcGx5KHRoaXMsIGFyZ3VtZW50cykgfHwgdGhpcztcbiAgICAgICAgICAgIF90aGlzLnByb3BvcCA9IHRydWU7XG4gICAgICAgICAgICByZXR1cm4gX3RoaXM7XG4gICAgICAgIH1cbiAgICAgICAgJE5vdC5wcm90b3R5cGUuaW5pdCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHRoaXMuX3F1ZXJ5T3BlcmF0aW9uID0gY3JlYXRlUXVlcnlPcGVyYXRpb24odGhpcy5wYXJhbXMsIHRoaXMub3duZXJ5UXVlcnksIHRoaXMub3B0aW9ucyk7XG4gICAgICAgIH07XG4gICAgICAgICROb3QucHJvdG90eXBlLnJlc2V0ID0gZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgX3N1cGVyLnByb3RvdHlwZS5yZXNldC5jYWxsKHRoaXMpO1xuICAgICAgICAgICAgdGhpcy5fcXVlcnlPcGVyYXRpb24ucmVzZXQoKTtcbiAgICAgICAgfTtcbiAgICAgICAgJE5vdC5wcm90b3R5cGUubmV4dCA9IGZ1bmN0aW9uIChpdGVtLCBrZXksIG93bmVyLCByb290KSB7XG4gICAgICAgICAgICB0aGlzLl9xdWVyeU9wZXJhdGlvbi5uZXh0KGl0ZW0sIGtleSwgb3duZXIsIHJvb3QpO1xuICAgICAgICAgICAgdGhpcy5kb25lID0gdGhpcy5fcXVlcnlPcGVyYXRpb24uZG9uZTtcbiAgICAgICAgICAgIHRoaXMua2VlcCA9ICF0aGlzLl9xdWVyeU9wZXJhdGlvbi5rZWVwO1xuICAgICAgICB9O1xuICAgICAgICByZXR1cm4gJE5vdDtcbiAgICB9KEJhc2VPcGVyYXRpb24pKTtcbiAgICB2YXIgJFNpemUgPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoX3N1cGVyKSB7XG4gICAgICAgIF9fZXh0ZW5kcygkU2l6ZSwgX3N1cGVyKTtcbiAgICAgICAgZnVuY3Rpb24gJFNpemUoKSB7XG4gICAgICAgICAgICB2YXIgX3RoaXMgPSBfc3VwZXIgIT09IG51bGwgJiYgX3N1cGVyLmFwcGx5KHRoaXMsIGFyZ3VtZW50cykgfHwgdGhpcztcbiAgICAgICAgICAgIF90aGlzLnByb3BvcCA9IHRydWU7XG4gICAgICAgICAgICByZXR1cm4gX3RoaXM7XG4gICAgICAgIH1cbiAgICAgICAgJFNpemUucHJvdG90eXBlLmluaXQgPSBmdW5jdGlvbiAoKSB7IH07XG4gICAgICAgICRTaXplLnByb3RvdHlwZS5uZXh0ID0gZnVuY3Rpb24gKGl0ZW0pIHtcbiAgICAgICAgICAgIGlmIChpc0FycmF5KGl0ZW0pICYmIGl0ZW0ubGVuZ3RoID09PSB0aGlzLnBhcmFtcykge1xuICAgICAgICAgICAgICAgIHRoaXMuZG9uZSA9IHRydWU7XG4gICAgICAgICAgICAgICAgdGhpcy5rZWVwID0gdHJ1ZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIC8vIGlmIChwYXJlbnQgJiYgcGFyZW50Lmxlbmd0aCA9PT0gdGhpcy5wYXJhbXMpIHtcbiAgICAgICAgICAgIC8vICAgdGhpcy5kb25lID0gdHJ1ZTtcbiAgICAgICAgICAgIC8vICAgdGhpcy5rZWVwID0gdHJ1ZTtcbiAgICAgICAgICAgIC8vIH1cbiAgICAgICAgfTtcbiAgICAgICAgcmV0dXJuICRTaXplO1xuICAgIH0oQmFzZU9wZXJhdGlvbikpO1xuICAgIHZhciBhc3NlcnRHcm91cE5vdEVtcHR5ID0gZnVuY3Rpb24gKHZhbHVlcykge1xuICAgICAgICBpZiAodmFsdWVzLmxlbmd0aCA9PT0gMCkge1xuICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKFwiJGFuZC8kb3IvJG5vciBtdXN0IGJlIGEgbm9uZW1wdHkgYXJyYXlcIik7XG4gICAgICAgIH1cbiAgICB9O1xuICAgIHZhciAkT3IgPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoX3N1cGVyKSB7XG4gICAgICAgIF9fZXh0ZW5kcygkT3IsIF9zdXBlcik7XG4gICAgICAgIGZ1bmN0aW9uICRPcigpIHtcbiAgICAgICAgICAgIHZhciBfdGhpcyA9IF9zdXBlciAhPT0gbnVsbCAmJiBfc3VwZXIuYXBwbHkodGhpcywgYXJndW1lbnRzKSB8fCB0aGlzO1xuICAgICAgICAgICAgX3RoaXMucHJvcG9wID0gZmFsc2U7XG4gICAgICAgICAgICByZXR1cm4gX3RoaXM7XG4gICAgICAgIH1cbiAgICAgICAgJE9yLnByb3RvdHlwZS5pbml0ID0gZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgdmFyIF90aGlzID0gdGhpcztcbiAgICAgICAgICAgIGFzc2VydEdyb3VwTm90RW1wdHkodGhpcy5wYXJhbXMpO1xuICAgICAgICAgICAgdGhpcy5fb3BzID0gdGhpcy5wYXJhbXMubWFwKGZ1bmN0aW9uIChvcCkge1xuICAgICAgICAgICAgICAgIHJldHVybiBjcmVhdGVRdWVyeU9wZXJhdGlvbihvcCwgbnVsbCwgX3RoaXMub3B0aW9ucyk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfTtcbiAgICAgICAgJE9yLnByb3RvdHlwZS5yZXNldCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHRoaXMuZG9uZSA9IGZhbHNlO1xuICAgICAgICAgICAgdGhpcy5rZWVwID0gZmFsc2U7XG4gICAgICAgICAgICBmb3IgKHZhciBpID0gMCwgbGVuZ3RoXzIgPSB0aGlzLl9vcHMubGVuZ3RoOyBpIDwgbGVuZ3RoXzI7IGkrKykge1xuICAgICAgICAgICAgICAgIHRoaXMuX29wc1tpXS5yZXNldCgpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9O1xuICAgICAgICAkT3IucHJvdG90eXBlLm5leHQgPSBmdW5jdGlvbiAoaXRlbSwga2V5LCBvd25lcikge1xuICAgICAgICAgICAgdmFyIGRvbmUgPSBmYWxzZTtcbiAgICAgICAgICAgIHZhciBzdWNjZXNzID0gZmFsc2U7XG4gICAgICAgICAgICBmb3IgKHZhciBpID0gMCwgbGVuZ3RoXzMgPSB0aGlzLl9vcHMubGVuZ3RoOyBpIDwgbGVuZ3RoXzM7IGkrKykge1xuICAgICAgICAgICAgICAgIHZhciBvcCA9IHRoaXMuX29wc1tpXTtcbiAgICAgICAgICAgICAgICBvcC5uZXh0KGl0ZW0sIGtleSwgb3duZXIpO1xuICAgICAgICAgICAgICAgIGlmIChvcC5rZWVwKSB7XG4gICAgICAgICAgICAgICAgICAgIGRvbmUgPSB0cnVlO1xuICAgICAgICAgICAgICAgICAgICBzdWNjZXNzID0gb3Aua2VlcDtcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdGhpcy5rZWVwID0gc3VjY2VzcztcbiAgICAgICAgICAgIHRoaXMuZG9uZSA9IGRvbmU7XG4gICAgICAgIH07XG4gICAgICAgIHJldHVybiAkT3I7XG4gICAgfShCYXNlT3BlcmF0aW9uKSk7XG4gICAgdmFyICROb3IgPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoX3N1cGVyKSB7XG4gICAgICAgIF9fZXh0ZW5kcygkTm9yLCBfc3VwZXIpO1xuICAgICAgICBmdW5jdGlvbiAkTm9yKCkge1xuICAgICAgICAgICAgdmFyIF90aGlzID0gX3N1cGVyICE9PSBudWxsICYmIF9zdXBlci5hcHBseSh0aGlzLCBhcmd1bWVudHMpIHx8IHRoaXM7XG4gICAgICAgICAgICBfdGhpcy5wcm9wb3AgPSBmYWxzZTtcbiAgICAgICAgICAgIHJldHVybiBfdGhpcztcbiAgICAgICAgfVxuICAgICAgICAkTm9yLnByb3RvdHlwZS5uZXh0ID0gZnVuY3Rpb24gKGl0ZW0sIGtleSwgb3duZXIpIHtcbiAgICAgICAgICAgIF9zdXBlci5wcm90b3R5cGUubmV4dC5jYWxsKHRoaXMsIGl0ZW0sIGtleSwgb3duZXIpO1xuICAgICAgICAgICAgdGhpcy5rZWVwID0gIXRoaXMua2VlcDtcbiAgICAgICAgfTtcbiAgICAgICAgcmV0dXJuICROb3I7XG4gICAgfSgkT3IpKTtcbiAgICB2YXIgJEluID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKF9zdXBlcikge1xuICAgICAgICBfX2V4dGVuZHMoJEluLCBfc3VwZXIpO1xuICAgICAgICBmdW5jdGlvbiAkSW4oKSB7XG4gICAgICAgICAgICB2YXIgX3RoaXMgPSBfc3VwZXIgIT09IG51bGwgJiYgX3N1cGVyLmFwcGx5KHRoaXMsIGFyZ3VtZW50cykgfHwgdGhpcztcbiAgICAgICAgICAgIF90aGlzLnByb3BvcCA9IHRydWU7XG4gICAgICAgICAgICByZXR1cm4gX3RoaXM7XG4gICAgICAgIH1cbiAgICAgICAgJEluLnByb3RvdHlwZS5pbml0ID0gZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgdmFyIF90aGlzID0gdGhpcztcbiAgICAgICAgICAgIHRoaXMuX3Rlc3RlcnMgPSB0aGlzLnBhcmFtcy5tYXAoZnVuY3Rpb24gKHZhbHVlKSB7XG4gICAgICAgICAgICAgICAgaWYgKGNvbnRhaW5zT3BlcmF0aW9uKHZhbHVlLCBfdGhpcy5vcHRpb25zKSkge1xuICAgICAgICAgICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoXCJjYW5ub3QgbmVzdCAkIHVuZGVyIFwiICsgX3RoaXMubmFtZS50b0xvd2VyQ2FzZSgpKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgcmV0dXJuIGNyZWF0ZVRlc3Rlcih2YWx1ZSwgX3RoaXMub3B0aW9ucy5jb21wYXJlKTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9O1xuICAgICAgICAkSW4ucHJvdG90eXBlLm5leHQgPSBmdW5jdGlvbiAoaXRlbSwga2V5LCBvd25lcikge1xuICAgICAgICAgICAgdmFyIGRvbmUgPSBmYWxzZTtcbiAgICAgICAgICAgIHZhciBzdWNjZXNzID0gZmFsc2U7XG4gICAgICAgICAgICBmb3IgKHZhciBpID0gMCwgbGVuZ3RoXzQgPSB0aGlzLl90ZXN0ZXJzLmxlbmd0aDsgaSA8IGxlbmd0aF80OyBpKyspIHtcbiAgICAgICAgICAgICAgICB2YXIgdGVzdCA9IHRoaXMuX3Rlc3RlcnNbaV07XG4gICAgICAgICAgICAgICAgaWYgKHRlc3QoaXRlbSkpIHtcbiAgICAgICAgICAgICAgICAgICAgZG9uZSA9IHRydWU7XG4gICAgICAgICAgICAgICAgICAgIHN1Y2Nlc3MgPSB0cnVlO1xuICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB0aGlzLmtlZXAgPSBzdWNjZXNzO1xuICAgICAgICAgICAgdGhpcy5kb25lID0gZG9uZTtcbiAgICAgICAgfTtcbiAgICAgICAgcmV0dXJuICRJbjtcbiAgICB9KEJhc2VPcGVyYXRpb24pKTtcbiAgICB2YXIgJE5pbiA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uIChfc3VwZXIpIHtcbiAgICAgICAgX19leHRlbmRzKCROaW4sIF9zdXBlcik7XG4gICAgICAgIGZ1bmN0aW9uICROaW4ocGFyYW1zLCBvd25lclF1ZXJ5LCBvcHRpb25zLCBuYW1lKSB7XG4gICAgICAgICAgICB2YXIgX3RoaXMgPSBfc3VwZXIuY2FsbCh0aGlzLCBwYXJhbXMsIG93bmVyUXVlcnksIG9wdGlvbnMsIG5hbWUpIHx8IHRoaXM7XG4gICAgICAgICAgICBfdGhpcy5wcm9wb3AgPSB0cnVlO1xuICAgICAgICAgICAgX3RoaXMuX2luID0gbmV3ICRJbihwYXJhbXMsIG93bmVyUXVlcnksIG9wdGlvbnMsIG5hbWUpO1xuICAgICAgICAgICAgcmV0dXJuIF90aGlzO1xuICAgICAgICB9XG4gICAgICAgICROaW4ucHJvdG90eXBlLm5leHQgPSBmdW5jdGlvbiAoaXRlbSwga2V5LCBvd25lciwgcm9vdCkge1xuICAgICAgICAgICAgdGhpcy5faW4ubmV4dChpdGVtLCBrZXksIG93bmVyKTtcbiAgICAgICAgICAgIGlmIChpc0FycmF5KG93bmVyKSAmJiAhcm9vdCkge1xuICAgICAgICAgICAgICAgIGlmICh0aGlzLl9pbi5rZWVwKSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMua2VlcCA9IGZhbHNlO1xuICAgICAgICAgICAgICAgICAgICB0aGlzLmRvbmUgPSB0cnVlO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBlbHNlIGlmIChrZXkgPT0gb3duZXIubGVuZ3RoIC0gMSkge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLmtlZXAgPSB0cnVlO1xuICAgICAgICAgICAgICAgICAgICB0aGlzLmRvbmUgPSB0cnVlO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgIHRoaXMua2VlcCA9ICF0aGlzLl9pbi5rZWVwO1xuICAgICAgICAgICAgICAgIHRoaXMuZG9uZSA9IHRydWU7XG4gICAgICAgICAgICB9XG4gICAgICAgIH07XG4gICAgICAgICROaW4ucHJvdG90eXBlLnJlc2V0ID0gZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgX3N1cGVyLnByb3RvdHlwZS5yZXNldC5jYWxsKHRoaXMpO1xuICAgICAgICAgICAgdGhpcy5faW4ucmVzZXQoKTtcbiAgICAgICAgfTtcbiAgICAgICAgcmV0dXJuICROaW47XG4gICAgfShCYXNlT3BlcmF0aW9uKSk7XG4gICAgdmFyICRFeGlzdHMgPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoX3N1cGVyKSB7XG4gICAgICAgIF9fZXh0ZW5kcygkRXhpc3RzLCBfc3VwZXIpO1xuICAgICAgICBmdW5jdGlvbiAkRXhpc3RzKCkge1xuICAgICAgICAgICAgdmFyIF90aGlzID0gX3N1cGVyICE9PSBudWxsICYmIF9zdXBlci5hcHBseSh0aGlzLCBhcmd1bWVudHMpIHx8IHRoaXM7XG4gICAgICAgICAgICBfdGhpcy5wcm9wb3AgPSB0cnVlO1xuICAgICAgICAgICAgcmV0dXJuIF90aGlzO1xuICAgICAgICB9XG4gICAgICAgICRFeGlzdHMucHJvdG90eXBlLm5leHQgPSBmdW5jdGlvbiAoaXRlbSwga2V5LCBvd25lcikge1xuICAgICAgICAgICAgaWYgKG93bmVyLmhhc093blByb3BlcnR5KGtleSkgPT09IHRoaXMucGFyYW1zKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5kb25lID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICB0aGlzLmtlZXAgPSB0cnVlO1xuICAgICAgICAgICAgfVxuICAgICAgICB9O1xuICAgICAgICByZXR1cm4gJEV4aXN0cztcbiAgICB9KEJhc2VPcGVyYXRpb24pKTtcbiAgICB2YXIgJEFuZCA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uIChfc3VwZXIpIHtcbiAgICAgICAgX19leHRlbmRzKCRBbmQsIF9zdXBlcik7XG4gICAgICAgIGZ1bmN0aW9uICRBbmQocGFyYW1zLCBvd25lcnlRdWVyeSwgb3B0aW9ucywgbmFtZSkge1xuICAgICAgICAgICAgdmFyIF90aGlzID0gX3N1cGVyLmNhbGwodGhpcywgcGFyYW1zLCBvd25lcnlRdWVyeSwgb3B0aW9ucywgcGFyYW1zLm1hcChmdW5jdGlvbiAocXVlcnkpIHsgcmV0dXJuIGNyZWF0ZVF1ZXJ5T3BlcmF0aW9uKHF1ZXJ5LCBvd25lcnlRdWVyeSwgb3B0aW9ucyk7IH0pLCBuYW1lKSB8fCB0aGlzO1xuICAgICAgICAgICAgX3RoaXMucHJvcG9wID0gZmFsc2U7XG4gICAgICAgICAgICBhc3NlcnRHcm91cE5vdEVtcHR5KHBhcmFtcyk7XG4gICAgICAgICAgICByZXR1cm4gX3RoaXM7XG4gICAgICAgIH1cbiAgICAgICAgJEFuZC5wcm90b3R5cGUubmV4dCA9IGZ1bmN0aW9uIChpdGVtLCBrZXksIG93bmVyLCByb290KSB7XG4gICAgICAgICAgICB0aGlzLmNoaWxkcmVuTmV4dChpdGVtLCBrZXksIG93bmVyLCByb290KTtcbiAgICAgICAgfTtcbiAgICAgICAgcmV0dXJuICRBbmQ7XG4gICAgfShOYW1lZEdyb3VwT3BlcmF0aW9uKSk7XG4gICAgdmFyICRBbGwgPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoX3N1cGVyKSB7XG4gICAgICAgIF9fZXh0ZW5kcygkQWxsLCBfc3VwZXIpO1xuICAgICAgICBmdW5jdGlvbiAkQWxsKHBhcmFtcywgb3duZXJ5UXVlcnksIG9wdGlvbnMsIG5hbWUpIHtcbiAgICAgICAgICAgIHZhciBfdGhpcyA9IF9zdXBlci5jYWxsKHRoaXMsIHBhcmFtcywgb3duZXJ5UXVlcnksIG9wdGlvbnMsIHBhcmFtcy5tYXAoZnVuY3Rpb24gKHF1ZXJ5KSB7IHJldHVybiBjcmVhdGVRdWVyeU9wZXJhdGlvbihxdWVyeSwgb3duZXJ5UXVlcnksIG9wdGlvbnMpOyB9KSwgbmFtZSkgfHwgdGhpcztcbiAgICAgICAgICAgIF90aGlzLnByb3BvcCA9IHRydWU7XG4gICAgICAgICAgICByZXR1cm4gX3RoaXM7XG4gICAgICAgIH1cbiAgICAgICAgJEFsbC5wcm90b3R5cGUubmV4dCA9IGZ1bmN0aW9uIChpdGVtLCBrZXksIG93bmVyLCByb290KSB7XG4gICAgICAgICAgICB0aGlzLmNoaWxkcmVuTmV4dChpdGVtLCBrZXksIG93bmVyLCByb290KTtcbiAgICAgICAgfTtcbiAgICAgICAgcmV0dXJuICRBbGw7XG4gICAgfShOYW1lZEdyb3VwT3BlcmF0aW9uKSk7XG4gICAgdmFyICRlcSA9IGZ1bmN0aW9uIChwYXJhbXMsIG93bmVyeVF1ZXJ5LCBvcHRpb25zKSB7XG4gICAgICAgIHJldHVybiBuZXcgRXF1YWxzT3BlcmF0aW9uKHBhcmFtcywgb3duZXJ5UXVlcnksIG9wdGlvbnMpO1xuICAgIH07XG4gICAgdmFyICRuZSA9IGZ1bmN0aW9uIChwYXJhbXMsIG93bmVyeVF1ZXJ5LCBvcHRpb25zLCBuYW1lKSB7IHJldHVybiBuZXcgJE5lKHBhcmFtcywgb3duZXJ5UXVlcnksIG9wdGlvbnMsIG5hbWUpOyB9O1xuICAgIHZhciAkb3IgPSBmdW5jdGlvbiAocGFyYW1zLCBvd25lcnlRdWVyeSwgb3B0aW9ucywgbmFtZSkgeyByZXR1cm4gbmV3ICRPcihwYXJhbXMsIG93bmVyeVF1ZXJ5LCBvcHRpb25zLCBuYW1lKTsgfTtcbiAgICB2YXIgJG5vciA9IGZ1bmN0aW9uIChwYXJhbXMsIG93bmVyeVF1ZXJ5LCBvcHRpb25zLCBuYW1lKSB7IHJldHVybiBuZXcgJE5vcihwYXJhbXMsIG93bmVyeVF1ZXJ5LCBvcHRpb25zLCBuYW1lKTsgfTtcbiAgICB2YXIgJGVsZW1NYXRjaCA9IGZ1bmN0aW9uIChwYXJhbXMsIG93bmVyeVF1ZXJ5LCBvcHRpb25zLCBuYW1lKSB7IHJldHVybiBuZXcgJEVsZW1NYXRjaChwYXJhbXMsIG93bmVyeVF1ZXJ5LCBvcHRpb25zLCBuYW1lKTsgfTtcbiAgICB2YXIgJG5pbiA9IGZ1bmN0aW9uIChwYXJhbXMsIG93bmVyeVF1ZXJ5LCBvcHRpb25zLCBuYW1lKSB7IHJldHVybiBuZXcgJE5pbihwYXJhbXMsIG93bmVyeVF1ZXJ5LCBvcHRpb25zLCBuYW1lKTsgfTtcbiAgICB2YXIgJGluID0gZnVuY3Rpb24gKHBhcmFtcywgb3duZXJ5UXVlcnksIG9wdGlvbnMsIG5hbWUpIHtcbiAgICAgICAgcmV0dXJuIG5ldyAkSW4ocGFyYW1zLCBvd25lcnlRdWVyeSwgb3B0aW9ucywgbmFtZSk7XG4gICAgfTtcbiAgICB2YXIgJGx0ID0gbnVtZXJpY2FsT3BlcmF0aW9uKGZ1bmN0aW9uIChwYXJhbXMpIHsgcmV0dXJuIGZ1bmN0aW9uIChiKSB7IHJldHVybiBiIDwgcGFyYW1zOyB9OyB9KTtcbiAgICB2YXIgJGx0ZSA9IG51bWVyaWNhbE9wZXJhdGlvbihmdW5jdGlvbiAocGFyYW1zKSB7IHJldHVybiBmdW5jdGlvbiAoYikgeyByZXR1cm4gYiA8PSBwYXJhbXM7IH07IH0pO1xuICAgIHZhciAkZ3QgPSBudW1lcmljYWxPcGVyYXRpb24oZnVuY3Rpb24gKHBhcmFtcykgeyByZXR1cm4gZnVuY3Rpb24gKGIpIHsgcmV0dXJuIGIgPiBwYXJhbXM7IH07IH0pO1xuICAgIHZhciAkZ3RlID0gbnVtZXJpY2FsT3BlcmF0aW9uKGZ1bmN0aW9uIChwYXJhbXMpIHsgcmV0dXJuIGZ1bmN0aW9uIChiKSB7IHJldHVybiBiID49IHBhcmFtczsgfTsgfSk7XG4gICAgdmFyICRtb2QgPSBmdW5jdGlvbiAoX2EsIG93bmVyeVF1ZXJ5LCBvcHRpb25zKSB7XG4gICAgICAgIHZhciBtb2QgPSBfYVswXSwgZXF1YWxzVmFsdWUgPSBfYVsxXTtcbiAgICAgICAgcmV0dXJuIG5ldyBFcXVhbHNPcGVyYXRpb24oZnVuY3Rpb24gKGIpIHsgcmV0dXJuIGNvbXBhcmFibGUoYikgJSBtb2QgPT09IGVxdWFsc1ZhbHVlOyB9LCBvd25lcnlRdWVyeSwgb3B0aW9ucyk7XG4gICAgfTtcbiAgICB2YXIgJGV4aXN0cyA9IGZ1bmN0aW9uIChwYXJhbXMsIG93bmVyeVF1ZXJ5LCBvcHRpb25zLCBuYW1lKSB7IHJldHVybiBuZXcgJEV4aXN0cyhwYXJhbXMsIG93bmVyeVF1ZXJ5LCBvcHRpb25zLCBuYW1lKTsgfTtcbiAgICB2YXIgJHJlZ2V4ID0gZnVuY3Rpb24gKHBhdHRlcm4sIG93bmVyeVF1ZXJ5LCBvcHRpb25zKSB7XG4gICAgICAgIHJldHVybiBuZXcgRXF1YWxzT3BlcmF0aW9uKG5ldyBSZWdFeHAocGF0dGVybiwgb3duZXJ5UXVlcnkuJG9wdGlvbnMpLCBvd25lcnlRdWVyeSwgb3B0aW9ucyk7XG4gICAgfTtcbiAgICB2YXIgJG5vdCA9IGZ1bmN0aW9uIChwYXJhbXMsIG93bmVyeVF1ZXJ5LCBvcHRpb25zLCBuYW1lKSB7IHJldHVybiBuZXcgJE5vdChwYXJhbXMsIG93bmVyeVF1ZXJ5LCBvcHRpb25zLCBuYW1lKTsgfTtcbiAgICB2YXIgdHlwZUFsaWFzZXMgPSB7XG4gICAgICAgIG51bWJlcjogZnVuY3Rpb24gKHYpIHsgcmV0dXJuIHR5cGVvZiB2ID09PSBcIm51bWJlclwiOyB9LFxuICAgICAgICBzdHJpbmc6IGZ1bmN0aW9uICh2KSB7IHJldHVybiB0eXBlb2YgdiA9PT0gXCJzdHJpbmdcIjsgfSxcbiAgICAgICAgYm9vbDogZnVuY3Rpb24gKHYpIHsgcmV0dXJuIHR5cGVvZiB2ID09PSBcImJvb2xlYW5cIjsgfSxcbiAgICAgICAgYXJyYXk6IGZ1bmN0aW9uICh2KSB7IHJldHVybiBBcnJheS5pc0FycmF5KHYpOyB9LFxuICAgICAgICBudWxsOiBmdW5jdGlvbiAodikgeyByZXR1cm4gdiA9PT0gbnVsbDsgfSxcbiAgICAgICAgdGltZXN0YW1wOiBmdW5jdGlvbiAodikgeyByZXR1cm4gdiBpbnN0YW5jZW9mIERhdGU7IH1cbiAgICB9O1xuICAgIHZhciAkdHlwZSA9IGZ1bmN0aW9uIChjbGF6eiwgb3duZXJ5UXVlcnksIG9wdGlvbnMpIHtcbiAgICAgICAgcmV0dXJuIG5ldyBFcXVhbHNPcGVyYXRpb24oZnVuY3Rpb24gKGIpIHtcbiAgICAgICAgICAgIGlmICh0eXBlb2YgY2xhenogPT09IFwic3RyaW5nXCIpIHtcbiAgICAgICAgICAgICAgICBpZiAoIXR5cGVBbGlhc2VzW2NsYXp6XSkge1xuICAgICAgICAgICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoXCJUeXBlIGFsaWFzIGRvZXMgbm90IGV4aXN0XCIpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICByZXR1cm4gdHlwZUFsaWFzZXNbY2xhenpdKGIpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIGIgIT0gbnVsbCA/IGIgaW5zdGFuY2VvZiBjbGF6eiB8fCBiLmNvbnN0cnVjdG9yID09PSBjbGF6eiA6IGZhbHNlO1xuICAgICAgICB9LCBvd25lcnlRdWVyeSwgb3B0aW9ucyk7XG4gICAgfTtcbiAgICB2YXIgJGFuZCA9IGZ1bmN0aW9uIChwYXJhbXMsIG93bmVyUXVlcnksIG9wdGlvbnMsIG5hbWUpIHsgcmV0dXJuIG5ldyAkQW5kKHBhcmFtcywgb3duZXJRdWVyeSwgb3B0aW9ucywgbmFtZSk7IH07XG4gICAgdmFyICRhbGwgPSBmdW5jdGlvbiAocGFyYW1zLCBvd25lclF1ZXJ5LCBvcHRpb25zLCBuYW1lKSB7IHJldHVybiBuZXcgJEFsbChwYXJhbXMsIG93bmVyUXVlcnksIG9wdGlvbnMsIG5hbWUpOyB9O1xuICAgIHZhciAkc2l6ZSA9IGZ1bmN0aW9uIChwYXJhbXMsIG93bmVyUXVlcnksIG9wdGlvbnMpIHsgcmV0dXJuIG5ldyAkU2l6ZShwYXJhbXMsIG93bmVyUXVlcnksIG9wdGlvbnMsIFwiJHNpemVcIik7IH07XG4gICAgdmFyICRvcHRpb25zID0gZnVuY3Rpb24gKCkgeyByZXR1cm4gbnVsbDsgfTtcbiAgICB2YXIgJHdoZXJlID0gZnVuY3Rpb24gKHBhcmFtcywgb3duZXJRdWVyeSwgb3B0aW9ucykge1xuICAgICAgICB2YXIgdGVzdDtcbiAgICAgICAgaWYgKGlzRnVuY3Rpb24ocGFyYW1zKSkge1xuICAgICAgICAgICAgdGVzdCA9IHBhcmFtcztcbiAgICAgICAgfVxuICAgICAgICBlbHNlIGlmICghcHJvY2Vzcy5lbnYuQ1NQX0VOQUJMRUQpIHtcbiAgICAgICAgICAgIHRlc3QgPSBuZXcgRnVuY3Rpb24oXCJvYmpcIiwgXCJyZXR1cm4gXCIgKyBwYXJhbXMpO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKFwiSW4gQ1NQIG1vZGUsIHNpZnQgZG9lcyBub3Qgc3VwcG9ydCBzdHJpbmdzIGluIFxcXCIkd2hlcmVcXFwiIGNvbmRpdGlvblwiKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gbmV3IEVxdWFsc09wZXJhdGlvbihmdW5jdGlvbiAoYikgeyByZXR1cm4gdGVzdC5iaW5kKGIpKGIpOyB9LCBvd25lclF1ZXJ5LCBvcHRpb25zKTtcbiAgICB9O1xuXG4gICAgdmFyIGRlZmF1bHRPcGVyYXRpb25zID0gLyojX19QVVJFX18qL09iamVjdC5mcmVlemUoe1xuICAgICAgICBfX3Byb3RvX186IG51bGwsXG4gICAgICAgICRTaXplOiAkU2l6ZSxcbiAgICAgICAgJGVxOiAkZXEsXG4gICAgICAgICRuZTogJG5lLFxuICAgICAgICAkb3I6ICRvcixcbiAgICAgICAgJG5vcjogJG5vcixcbiAgICAgICAgJGVsZW1NYXRjaDogJGVsZW1NYXRjaCxcbiAgICAgICAgJG5pbjogJG5pbixcbiAgICAgICAgJGluOiAkaW4sXG4gICAgICAgICRsdDogJGx0LFxuICAgICAgICAkbHRlOiAkbHRlLFxuICAgICAgICAkZ3Q6ICRndCxcbiAgICAgICAgJGd0ZTogJGd0ZSxcbiAgICAgICAgJG1vZDogJG1vZCxcbiAgICAgICAgJGV4aXN0czogJGV4aXN0cyxcbiAgICAgICAgJHJlZ2V4OiAkcmVnZXgsXG4gICAgICAgICRub3Q6ICRub3QsXG4gICAgICAgICR0eXBlOiAkdHlwZSxcbiAgICAgICAgJGFuZDogJGFuZCxcbiAgICAgICAgJGFsbDogJGFsbCxcbiAgICAgICAgJHNpemU6ICRzaXplLFxuICAgICAgICAkb3B0aW9uczogJG9wdGlvbnMsXG4gICAgICAgICR3aGVyZTogJHdoZXJlXG4gICAgfSk7XG5cbiAgICB2YXIgY3JlYXRlRGVmYXVsdFF1ZXJ5T3BlcmF0aW9uID0gZnVuY3Rpb24gKHF1ZXJ5LCBvd25lclF1ZXJ5LCBfYSkge1xuICAgICAgICB2YXIgX2IgPSBfYSA9PT0gdm9pZCAwID8ge30gOiBfYSwgY29tcGFyZSA9IF9iLmNvbXBhcmUsIG9wZXJhdGlvbnMgPSBfYi5vcGVyYXRpb25zO1xuICAgICAgICByZXR1cm4gY3JlYXRlUXVlcnlPcGVyYXRpb24ocXVlcnksIG93bmVyUXVlcnksIHtcbiAgICAgICAgICAgIGNvbXBhcmU6IGNvbXBhcmUsXG4gICAgICAgICAgICBvcGVyYXRpb25zOiBPYmplY3QuYXNzaWduKHt9LCBkZWZhdWx0T3BlcmF0aW9ucywgb3BlcmF0aW9ucyB8fCB7fSlcbiAgICAgICAgfSk7XG4gICAgfTtcbiAgICB2YXIgY3JlYXRlRGVmYXVsdFF1ZXJ5VGVzdGVyID0gZnVuY3Rpb24gKHF1ZXJ5LCBvcHRpb25zKSB7XG4gICAgICAgIGlmIChvcHRpb25zID09PSB2b2lkIDApIHsgb3B0aW9ucyA9IHt9OyB9XG4gICAgICAgIHZhciBvcCA9IGNyZWF0ZURlZmF1bHRRdWVyeU9wZXJhdGlvbihxdWVyeSwgbnVsbCwgb3B0aW9ucyk7XG4gICAgICAgIHJldHVybiBjcmVhdGVPcGVyYXRpb25UZXN0ZXIob3ApO1xuICAgIH07XG5cbiAgICBleHBvcnRzLiRTaXplID0gJFNpemU7XG4gICAgZXhwb3J0cy4kYWxsID0gJGFsbDtcbiAgICBleHBvcnRzLiRhbmQgPSAkYW5kO1xuICAgIGV4cG9ydHMuJGVsZW1NYXRjaCA9ICRlbGVtTWF0Y2g7XG4gICAgZXhwb3J0cy4kZXEgPSAkZXE7XG4gICAgZXhwb3J0cy4kZXhpc3RzID0gJGV4aXN0cztcbiAgICBleHBvcnRzLiRndCA9ICRndDtcbiAgICBleHBvcnRzLiRndGUgPSAkZ3RlO1xuICAgIGV4cG9ydHMuJGluID0gJGluO1xuICAgIGV4cG9ydHMuJGx0ID0gJGx0O1xuICAgIGV4cG9ydHMuJGx0ZSA9ICRsdGU7XG4gICAgZXhwb3J0cy4kbW9kID0gJG1vZDtcbiAgICBleHBvcnRzLiRuZSA9ICRuZTtcbiAgICBleHBvcnRzLiRuaW4gPSAkbmluO1xuICAgIGV4cG9ydHMuJG5vciA9ICRub3I7XG4gICAgZXhwb3J0cy4kbm90ID0gJG5vdDtcbiAgICBleHBvcnRzLiRvcHRpb25zID0gJG9wdGlvbnM7XG4gICAgZXhwb3J0cy4kb3IgPSAkb3I7XG4gICAgZXhwb3J0cy4kcmVnZXggPSAkcmVnZXg7XG4gICAgZXhwb3J0cy4kc2l6ZSA9ICRzaXplO1xuICAgIGV4cG9ydHMuJHR5cGUgPSAkdHlwZTtcbiAgICBleHBvcnRzLiR3aGVyZSA9ICR3aGVyZTtcbiAgICBleHBvcnRzLkVxdWFsc09wZXJhdGlvbiA9IEVxdWFsc09wZXJhdGlvbjtcbiAgICBleHBvcnRzLmNyZWF0ZURlZmF1bHRRdWVyeU9wZXJhdGlvbiA9IGNyZWF0ZURlZmF1bHRRdWVyeU9wZXJhdGlvbjtcbiAgICBleHBvcnRzLmNyZWF0ZUVxdWFsc09wZXJhdGlvbiA9IGNyZWF0ZUVxdWFsc09wZXJhdGlvbjtcbiAgICBleHBvcnRzLmNyZWF0ZU9wZXJhdGlvblRlc3RlciA9IGNyZWF0ZU9wZXJhdGlvblRlc3RlcjtcbiAgICBleHBvcnRzLmNyZWF0ZVF1ZXJ5T3BlcmF0aW9uID0gY3JlYXRlUXVlcnlPcGVyYXRpb247XG4gICAgZXhwb3J0cy5jcmVhdGVRdWVyeVRlc3RlciA9IGNyZWF0ZVF1ZXJ5VGVzdGVyO1xuICAgIGV4cG9ydHMuZGVmYXVsdCA9IGNyZWF0ZURlZmF1bHRRdWVyeVRlc3RlcjtcblxuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCAnX19lc01vZHVsZScsIHsgdmFsdWU6IHRydWUgfSk7XG5cbn0pKSk7XG4vLyMgc291cmNlTWFwcGluZ1VSTD1pbmRleC5qcy5tYXBcbiJdLCJuYW1lcyI6W10sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///../server/node_modules/sift/lib/index.js\n");

/***/ })

};
;